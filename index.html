<!DOCTYPE html>
<html lang="fr" dir="ltr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Apprentissage du Vocabulaire Arabe</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Georgia', 'Times New Roman', serif;
            background: #f5f5f0;
            min-height: 100vh;
            padding: 20px;
            color: #2c3e50;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            border-radius: 2px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.08);
            overflow: hidden;
            border-top: 5px solid #2c5f2d;
        }

        .header {
            background: linear-gradient(135deg, #2c5f2d 0%, #97bc62 100%);
            color: white;
            padding: 40px 30px;
            text-align: center;
            border-bottom: 3px solid #1a3a1b;
        }

        .header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
            font-weight: 600;
            letter-spacing: 1px;
        }

        .header p {
            font-size: 1.1em;
            opacity: 0.95;
            font-family: 'Segoe UI', sans-serif;
        }

        .tabs {
            display: flex;
            background: #fafaf8;
            border-bottom: 2px solid #d4d4d0;
        }

        .tab {
            flex: 1;
            padding: 18px 20px;
            text-align: center;
            cursor: pointer;
            font-size: 1.05em;
            font-weight: 500;
            transition: all 0.3s;
            border: none;
            background: transparent;
            font-family: 'Segoe UI', sans-serif;
            color: #555;
        }

        .tab:hover {
            background: #f0f0ec;
            color: #2c5f2d;
        }

        .tab.active {
            background: white;
            color: #2c5f2d;
            border-bottom: 3px solid #2c5f2d;
            font-weight: 600;
        }

        .content {
            padding: 35px;
            background: #ffffff;
        }

        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
        }

        /* Vocabulaire Tab */
        .category {
            margin-bottom: 45px;
            background: #fafaf8;
            padding: 25px;
            border-radius: 2px;
            border-left: 4px solid #2c5f2d;
        }

        .category-title {
            font-size: 1.8em;
            color: #2c5f2d;
            margin-bottom: 25px;
            padding-bottom: 12px;
            border-bottom: 2px solid #97bc62;
            font-family: 'Georgia', serif;
            font-weight: 600;
        }

        .vocab-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 18px;
            margin-bottom: 20px;
        }

        .vocab-item {
            background: white;
            padding: 18px;
            border-radius: 2px;
            border: 1px solid #e0e0dc;
            border-left: 4px solid #97bc62;
            transition: all 0.2s;
        }

        .vocab-item:hover {
            box-shadow: 0 3px 12px rgba(0,0,0,0.08);
            transform: translateY(-2px);
        }

        .arabic-text {
            font-size: 1.5em;
            font-weight: 600;
            color: #1a3a1b;
            margin-bottom: 8px;
            direction: rtl;
            font-family: 'Arial', sans-serif;
        }

        .french-text {
            color: #666;
            font-size: 1.05em;
            font-family: 'Segoe UI', sans-serif;
        }

        /* Flashcards Tab */
        .flashcard-controls {
            display: flex;
            gap: 12px;
            margin-bottom: 35px;
            flex-wrap: wrap;
            padding: 20px;
            background: #fafaf8;
            border-radius: 2px;
        }

        .category-btn {
            padding: 11px 22px;
            border: 2px solid #2c5f2d;
            background: white;
            color: #2c5f2d;
            border-radius: 2px;
            cursor: pointer;
            font-size: 0.95em;
            font-weight: 500;
            transition: all 0.3s;
            font-family: 'Segoe UI', sans-serif;
        }

        .category-btn:hover {
            background: #2c5f2d;
            color: white;
        }

        .category-btn.active {
            background: #2c5f2d;
            color: white;
            font-weight: 600;
        }

        .flashcard-container {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 25px;
            padding: 10px;
        }

        .flashcard {
            width: 100%;
            height: 250px;
            perspective: 1000px;
            cursor: pointer;
        }

        .flashcard-inner {
            position: relative;
            width: 100%;
            height: 100%;
            transition: transform 0.6s;
            transform-style: preserve-3d;
        }

        .flashcard.flipped .flashcard-inner {
            transform: rotateY(180deg);
        }

        .flashcard-front, .flashcard-back {
            position: absolute;
            width: 100%;
            height: 100%;
            backface-visibility: hidden;
            display: flex;
            justify-content: center;
            align-items: center;
            border-radius: 2px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.15);
            padding: 25px;
            font-size: 1.5em;
            font-weight: 600;
            border: 3px solid #e0e0dc;
            text-align: center;
        }

        .flashcard-front {
            background: white;
            color: #2c5f2d;
            font-family: 'Segoe UI', sans-serif;
        }

        .flashcard-back {
            background: linear-gradient(135deg, #2c5f2d 0%, #4a7c59 100%);
            color: white;
            transform: rotateY(180deg);
            direction: rtl;
            font-family: 'Arial', sans-serif;
        }

        .flip-control-btn {
            padding: 12px 30px;
            border: none;
            border-radius: 2px;
            cursor: pointer;
            font-size: 1em;
            font-weight: 500;
            margin: 0 5px;
            transition: all 0.3s;
            font-family: 'Segoe UI', sans-serif;
        }

        .flip-control-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
        }

        .flip-control-btn.primary {
            background: #2c5f2d;
            color: white;
        }

        .flip-control-btn.primary:hover {
            background: #1a3a1b;
        }

        .flip-control-btn.secondary {
            background: #97bc62;
            color: white;
        }

        .flip-control-btn.secondary:hover {
            background: #7a9d4f;
        }

        /* Quiz Tab */
        .quiz-setup {
            text-align: center;
        }

        .quiz-setup h2 {
            color: #2c5f2d;
            margin-bottom: 35px;
            font-size: 2.2em;
            font-weight: 600;
        }

        .quiz-options {
            display: flex;
            flex-direction: column;
            gap: 25px;
            max-width: 700px;
            margin: 0 auto;
        }

        .quiz-option-group {
            background: #fafaf8;
            padding: 28px;
            border-radius: 2px;
            border: 1px solid #e0e0dc;
        }

        .quiz-option-group h3 {
            color: #2c5f2d;
            margin-bottom: 18px;
            font-size: 1.3em;
            font-weight: 600;
        }

        .quiz-buttons {
            display: flex;
            flex-wrap: wrap;
            gap: 12px;
            justify-content: center;
        }

        .start-quiz-btn {
            padding: 16px 40px;
            background: #2c5f2d;
            color: white;
            border: none;
            border-radius: 2px;
            font-size: 1.2em;
            font-weight: 600;
            cursor: pointer;
            margin-top: 35px;
            transition: all 0.3s;
            font-family: 'Segoe UI', sans-serif;
        }

        .start-quiz-btn:hover {
            background: #1a3a1b;
            box-shadow: 0 4px 12px rgba(44, 95, 45, 0.3);
        }

        .quiz-game {
            max-width: 850px;
            margin: 0 auto;
        }

        .quiz-progress {
            background: #fafaf8;
            padding: 25px;
            border-radius: 2px;
            margin-bottom: 35px;
            border: 1px solid #e0e0dc;
        }

        .progress-bar {
            width: 100%;
            height: 32px;
            background: #e8e8e4;
            border-radius: 2px;
            overflow: hidden;
            margin-bottom: 18px;
            border: 1px solid #d4d4d0;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #2c5f2d 0%, #4a7c59 100%);
            transition: width 0.4s;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: 600;
            font-family: 'Segoe UI', sans-serif;
        }

        .quiz-stats {
            display: flex;
            justify-content: space-around;
            font-size: 1.05em;
            color: #444;
            font-family: 'Segoe UI', sans-serif;
        }

        .stat {
            font-weight: 500;
        }

        .stat-value {
            color: #2c5f2d;
            font-size: 1.35em;
            font-weight: 700;
        }

        .question-card {
            background: linear-gradient(135deg, #2c5f2d 0%, #4a7c59 100%);
            color: white;
            padding: 45px;
            border-radius: 2px;
            text-align: center;
            margin-bottom: 35px;
            border: 3px solid #1a3a1b;
        }

        .question-text {
            font-size: 2.3em;
            font-weight: 600;
            margin-bottom: 12px;
            font-family: 'Segoe UI', sans-serif;
        }

        .question-hint {
            font-size: 1.15em;
            opacity: 0.92;
            font-family: 'Segoe UI', sans-serif;
        }

        .answer-options {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 16px;
        }

        .answer-btn {
            padding: 28px;
            background: white;
            border: 2px solid #d4d4d0;
            border-radius: 2px;
            font-size: 1.3em;
            cursor: pointer;
            transition: all 0.3s;
            font-weight: 600;
            color: #2c3e50;
            font-family: 'Arial', sans-serif;
        }

        .answer-btn:hover {
            border-color: #2c5f2d;
            background: #fafaf8;
        }

        .answer-btn.correct {
            background: #27ae60;
            color: white;
            border-color: #27ae60;
        }

        .answer-btn.incorrect {
            background: #c0392b;
            color: white;
            border-color: #c0392b;
        }

        .text-answer-container {
            max-width: 600px;
            margin: 0 auto;
        }

        .text-input {
            width: 100%;
            padding: 20px;
            font-size: 1.3em;
            border: 3px solid #d4d4d0;
            border-radius: 2px;
            text-align: center;
            font-family: 'Segoe UI', sans-serif;
            margin-bottom: 20px;
            transition: all 0.3s;
        }

        .text-input:focus {
            outline: none;
            border-color: #2c5f2d;
            box-shadow: 0 0 10px rgba(44, 95, 45, 0.2);
        }

        .text-input.correct {
            border-color: #27ae60;
            background: #d4edda;
        }

        .text-input.incorrect {
            border-color: #c0392b;
            background: #f8d7da;
        }

        .submit-answer-btn {
            padding: 16px 40px;
            background: #2c5f2d;
            color: white;
            border: none;
            border-radius: 2px;
            font-size: 1.1em;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            font-family: 'Segoe UI', sans-serif;
        }

        .submit-answer-btn:hover {
            background: #1a3a1b;
        }

        .submit-answer-btn:disabled {
            background: #ccc;
            cursor: not-allowed;
        }

        .attempts-display {
            font-size: 1.1em;
            color: #555;
            margin: 15px 0;
            font-weight: 500;
        }

        .attempts-display .remaining {
            color: #2c5f2d;
            font-weight: 700;
        }

        .feedback-message {
            padding: 15px;
            border-radius: 2px;
            margin: 15px 0;
            font-size: 1.05em;
            font-weight: 500;
        }

        .feedback-message.error {
            background: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }

        .feedback-message.success {
            background: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }

        .feedback-message.info {
            background: #d1ecf1;
            color: #0c5460;
            border: 1px solid #bee5eb;
        }

        .next-question-btn {
            padding: 14px 38px;
            background: #2c5f2d;
            color: white;
            border: none;
            border-radius: 2px;
            font-size: 1.1em;
            font-weight: 600;
            cursor: pointer;
            margin-top: 25px;
            transition: all 0.3s;
            font-family: 'Segoe UI', sans-serif;
        }

        .next-question-btn:hover {
            background: #1a3a1b;
        }

        .quiz-results {
            text-align: center;
            padding: 50px;
        }

        .results-title {
            font-size: 2.5em;
            color: #2c5f2d;
            margin-bottom: 35px;
            font-weight: 600;
        }

        .results-score {
            font-size: 4.5em;
            font-weight: 700;
            color: #2c5f2d;
            margin-bottom: 25px;
            font-family: 'Segoe UI', sans-serif;
        }

        .results-message {
            font-size: 1.4em;
            color: #555;
            margin-bottom: 35px;
            font-family: 'Segoe UI', sans-serif;
        }

        .restart-btn {
            padding: 16px 40px;
            background: #2c5f2d;
            color: white;
            border: none;
            border-radius: 2px;
            font-size: 1.2em;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            font-family: 'Segoe UI', sans-serif;
        }

        .restart-btn:hover {
            background: #1a3a1b;
            box-shadow: 0 4px 12px rgba(44, 95, 45, 0.3);
        }

        @media (max-width: 768px) {
            .flashcard-container {
                grid-template-columns: 1fr;
            }

            .flashcard {
                height: 200px;
            }

            .answer-options {
                grid-template-columns: 1fr;
            }

            .vocab-grid {
                grid-template-columns: 1fr;
            }

            .header h1 {
                font-size: 2em;
            }

            .content {
                padding: 20px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üìö Apprentissage du Vocabulaire Arabe</h1>
            <p>Apprenez l'arabe avec des fiches, des cartes mentales et des quiz interactifs</p>
            <div id="memory-stats" style="margin-top: 20px; font-size: 0.95em; opacity: 0.9;"></div>
        </div>

        <div class="tabs">
            <button class="tab active" onclick="switchTab(0)">üìñ Vocabulaire</button>
            <button class="tab" onclick="switchTab(1)">üé¥ Cartes Mentales</button>
            <button class="tab" onclick="switchTab(2)">üéØ Quiz</button>
        </div>

        <div class="content">
            <!-- Tab 1: Vocabulaire -->
            <div class="tab-content active" id="vocab-tab">
                <div id="vocabulary-container"></div>
            </div>

            <!-- Tab 2: Flashcards -->
            <div class="tab-content" id="flashcards-tab">
                <div class="flashcard-controls" id="flashcard-categories"></div>
                <div style="text-align: center; margin-bottom: 20px;">
                    <div style="margin-bottom: 15px;">
                        <span id="card-count" style="font-size: 1.1em; color: #2c5f2d; font-weight: 600;">0 cartes</span>
                    </div>
                    <button onclick="flipAllCards()" class="flip-control-btn primary">üîÑ Retourner tout</button>
                    <button onclick="resetAllCards()" class="flip-control-btn secondary">‚Ü©Ô∏è R√©initialiser</button>
                </div>
                <div class="flashcard-container" id="flashcard-container">
                    <!-- Les cartes seront g√©n√©r√©es ici -->
                </div>
            </div>

            <!-- Tab 3: Quiz -->
            <div class="tab-content" id="quiz-tab">
                <div class="quiz-setup" id="quiz-setup">
                    <h2>üéØ Configurez votre Quiz</h2>
                    <div class="quiz-options">
                        <div class="quiz-option-group">
                            <h3>Choisissez le mode de quiz :</h3>
                            <div class="quiz-buttons" id="quiz-mode-buttons">
                                <button class="category-btn active" onclick="selectQuizMode('qcm')">üìã QCM (Choix multiples)</button>
                                <button class="category-btn" onclick="selectQuizMode('texte')">‚úçÔ∏è Texte (√âcrire la r√©ponse)</button>
                            </div>
                        </div>
                        <div class="quiz-option-group">
                            <h3>Choisissez une cat√©gorie :</h3>
                            <div class="quiz-buttons" id="quiz-categories"></div>
                        </div>
                    </div>
                    <button class="start-quiz-btn" onclick="startQuiz()">Commencer le Quiz</button>
                    <div style="margin-top: 30px;">
                        <button onclick="resetMemory()" style="padding: 10px 20px; background: #dc3545; color: white; border: none; border-radius: 2px; cursor: pointer; font-size: 0.9em;">
                            üîÑ R√©initialiser les statistiques
                        </button>
                    </div>
                </div>

                <div class="quiz-game" id="quiz-game" style="display: none;">
                    <div class="quiz-progress">
                        <div class="progress-bar">
                            <div class="progress-fill" id="progress-fill">0%</div>
                        </div>
                        <div class="quiz-stats">
                            <div class="stat">
                                Question: <span class="stat-value" id="current-question">0</span> / <span id="total-questions">0</span>
                            </div>
                            <div class="stat">
                                Correct: <span class="stat-value" id="correct-answers">0</span>
                            </div>
                            <div class="stat">
                                Incorrect: <span class="stat-value" id="incorrect-answers">0</span>
                            </div>
                        </div>
                    </div>

                    <div class="question-card">
                        <div class="question-text" id="question-text"></div>
                        <div class="question-hint" id="question-hint"></div>
                    </div>

                    <!-- Mode QCM -->
                    <div id="qcm-mode" style="display: none;">
                        <div class="answer-options" id="answer-options"></div>
                    </div>

                    <!-- Mode Texte -->
                    <div id="text-mode" style="display: none;">
                        <div class="text-answer-container">
                            <div class="attempts-display" id="attempts-display">
                                Tentatives restantes : <span class="remaining" id="remaining-attempts">3</span>/3
                            </div>
                            <input type="text" class="text-input" id="text-answer-input" placeholder="√âcrivez votre r√©ponse ici..." autocomplete="off">
                            <div id="feedback-container"></div>
                            <button class="submit-answer-btn" id="submit-answer-btn" onclick="checkTextAnswer()">
                                Valider
                            </button>
                        </div>
                    </div>

                    <div style="text-align: center;">
                        <button class="next-question-btn" id="next-question-btn" onclick="nextQuestion()" style="display: none;">
                            Question Suivante
                        </button>
                    </div>
                </div>

                <div class="quiz-results" id="quiz-results" style="display: none;">
                    <div class="results-title">üéâ Quiz Termin√© !</div>
                    <div class="results-score" id="final-score"></div>
                    <div class="results-message" id="results-message"></div>
                    <button class="restart-btn" onclick="restartQuiz()">Recommencer</button>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Donn√©es du vocabulaire
        const vocabulary = {
            "Couleurs": [
                { arabic: "ÿ£Ÿéÿ≠ŸíŸÖŸéÿ±", french: "rouge (m.)" },
                { arabic: "ÿ≠ŸéŸÖŸíÿ±Ÿéÿßÿ°", french: "rouge (f.)" },
                { arabic: "ÿ£ŸéÿÆŸíÿ∂Ÿéÿ±", french: "vert (m.)" },
                { arabic: "ÿÆŸéÿ∂Ÿíÿ±Ÿéÿßÿ°", french: "vert (f.)" },
                { arabic: "ÿ£Ÿéÿ≤Ÿíÿ±ŸéŸÇ", french: "bleu (m.)" },
                { arabic: "ÿ≤Ÿéÿ±ŸíŸÇŸéÿßÿ°", french: "bleu (f.)" },
                { arabic: "ÿ£ŸéÿµŸíŸÅŸéÿ±", french: "jaune (m.)" },
                { arabic: "ÿµŸéŸÅŸíÿ±Ÿéÿßÿ°", french: "jaune (f.)" },
                { arabic: "ÿ£Ÿéÿ≥ŸíŸàŸéÿØ", french: "noir (m.)" },
                { arabic: "ÿ≥ŸéŸàŸíÿØŸéÿßÿ°", french: "noir (f.)" },
                { arabic: "ÿ£Ÿéÿ®ŸíŸäŸéÿ∂", french: "blanc (m.)" },
                { arabic: "ÿ®ŸéŸäŸíÿ∂Ÿéÿßÿ°", french: "blanc (f.)" }
            ],
            "Formes": [
                { arabic: "ŸÖŸèÿ±Ÿéÿ®ŸéŸëÿπ", french: "carr√©" },
                { arabic: "ŸÖŸèÿ≥Ÿíÿ™Ÿéÿ∑ŸêŸäŸÑ", french: "rectangle" },
                { arabic: "ÿÆŸéÿ∑Ÿë ŸÖŸèÿ≥Ÿíÿ™ŸéŸÇŸêŸäŸÖ", french: "ligne droite" },
                { arabic: "ŸÖŸèÿ´ŸéŸÑŸéŸëÿ´", french: "triangle" },
                { arabic: "ÿØŸéÿßÿ¶Ÿêÿ±Ÿéÿ©", french: "cercle" }
            ],
            "Signes Math√©matiques": [
                { arabic: "ÿ≤Ÿéÿßÿ¶ŸêÿØ", french: "plus (+)" },
                { arabic: "ŸÜŸéÿßŸÇŸêÿµ", french: "moins (-)" },
                { arabic: "ŸÅŸêŸä", french: "multipli√© par (√ó)" },
                { arabic: "ÿπŸéŸÑŸéŸâ", french: "divis√© par (√∑)" },
                { arabic: "ŸäŸèÿ≥ŸéÿßŸàŸêŸä", french: "√©gal (=)" },
                { arabic: "ŸÑŸéÿß ŸäŸèÿ≥ŸéÿßŸàŸêŸä", french: "n'est pas √©gal (‚â†)" },
                { arabic: "ŸÅŸêŸä ÿßŸÑŸíŸÖŸêÿ¶Ÿéÿ©", french: "pour cent (%)" }
            ],
            "Herbivores": [
                { arabic: "ÿ£Ÿéÿ≥ŸéÿØ", french: "lion" },
                { arabic: "ÿ®ŸéŸÇŸéÿ±Ÿéÿ©", french: "vache" },
                { arabic: "ÿ®Ÿéÿ∫ŸíŸÑ", french: "mulet" },
                { arabic: "ÿ´ŸéŸàŸíÿ±", french: "taureau" },
                { arabic: "ÿ¨ŸéÿßŸÖŸèŸàÿ≥", french: "buffle" },
                { arabic: "ÿ¨ŸéŸÖŸéŸÑ", french: "chameau" },
                { arabic: "ÿ≠ŸêÿµŸéÿßŸÜ", french: "cheval" },
                { arabic: "ÿ≠ŸêŸÖŸéÿßÿ±", french: "√¢ne" },
                { arabic: "ÿ≠ŸêŸÖŸéÿßÿ± ŸàŸéÿ≠Ÿíÿ¥ŸêŸä", french: "z√®bre" },
                { arabic: "ÿÆŸéÿ±ŸèŸàŸÅ", french: "mouton" },
                { arabic: "ÿ≤Ÿéÿ±ŸéÿßŸÅŸéÿ©", french: "girafe" },
                { arabic: "ÿ≥ŸèŸÑŸéÿ≠ŸíŸÅŸéÿßÿ©", french: "tortue" },
                { arabic: "ÿ∫Ÿéÿ≤ŸéÿßŸÑ", french: "gazelle" },
                { arabic: "ŸÅŸêŸäŸÑ", french: "√©l√©phant" },
                { arabic: "ŸÇŸêÿ±ŸíÿØ", french: "singe" },
                { arabic: "ŸÇŸèŸÜŸíŸÅŸèÿ∞", french: "h√©risson" },
                { arabic: "ŸàŸéÿ≠ŸêŸäÿØ ÿßŸÑŸíŸÇŸéÿ±ŸíŸÜ", french: "rhinoc√©ros" }
            ],
            "Carnivores": [
                { arabic: "ÿ™ŸêŸÖŸíÿ≥Ÿéÿßÿ≠", french: "crocodile" },
                { arabic: "ÿ´ŸéÿπŸíŸÑŸéÿ®", french: "renard" },
                { arabic: "ÿØŸèÿ®Ÿë", french: "ours" },
                { arabic: "ÿ∞Ÿêÿ¶Ÿíÿ®", french: "loup" },
                { arabic: "ÿ∂Ÿéÿ®Ÿèÿπ", french: "hy√®ne" },
                { arabic: "ŸÅŸéŸáŸíÿØ", french: "gu√©pard/l√©opard" },
                { arabic: "ŸÇŸêÿ∑ŸéŸëÿ©", french: "chatte" },
                { arabic: "ŸÉŸéŸÑŸíÿ®", french: "chien" },
                { arabic: "ŸÑŸéÿ®ŸíŸàŸéÿ©", french: "lionne" },
                { arabic: "ŸÜŸéŸÖŸêÿ±", french: "tigre" }
            ],
            "Oiseaux": [
                { arabic: "ÿ®Ÿéÿ®ŸéŸëÿ∫Ÿéÿßÿ°", french: "perroquet" },
                { arabic: "ÿ®Ÿéÿ∑ŸéŸëÿ©", french: "canard/cane" },
                { arabic: "ÿ®Ÿéÿ∑Ÿíÿ±ŸêŸäŸÇ", french: "pingouin" },
                { arabic: "ÿ®ŸèŸàŸÖŸéÿ©", french: "hibou" },
                { arabic: "ÿ≠ŸéŸÖŸéÿßŸÖŸéÿ©", french: "colombe/pigeon" },
                { arabic: "ÿÆŸèŸÅŸéŸëÿßÿ¥", french: "chauve-souris" },
                { arabic: "ÿØŸéÿ¨Ÿéÿßÿ¨Ÿéÿ©", french: "poule" },
                { arabic: "ÿµŸéŸÇŸíÿ±", french: "faucon" },
                { arabic: "ÿ∑ŸéÿßŸàŸèŸàÿ≥", french: "paon" },
                { arabic: "ÿπŸèÿµŸíŸÅŸèŸàÿ±", french: "moineau/oiseau" },
                { arabic: "ÿ∫Ÿèÿ±Ÿéÿßÿ®", french: "corbeau" },
                { arabic: "ŸÜŸéÿ≥Ÿíÿ±", french: "aigle" },
                { arabic: "ŸÜŸéÿπŸéÿßŸÖŸéÿ©", french: "autruche" }
            ],
            "Insectes": [
                { arabic: "ÿ®ŸéÿπŸèŸàÿ∂Ÿéÿ©", french: "moustique" },
                { arabic: "ÿ¨Ÿéÿ±ŸéÿßÿØŸéÿ©", french: "sauterelle" },
                { arabic: "ÿÆŸèŸÜŸíŸÅŸèÿ≥Ÿéÿßÿ°", french: "coccinelle" },
                { arabic: "ÿØŸèŸàÿØŸéÿ©", french: "ver" },
                { arabic: "ÿ∞Ÿèÿ®Ÿéÿßÿ®Ÿéÿ©", french: "mouche" },
                { arabic: "ÿµŸèÿ±ŸíÿµŸèŸàÿ±", french: "cafard" },
                { arabic: "ÿπŸéŸÜŸíŸÉŸéÿ®ŸèŸàÿ™", french: "araign√©e" },
                { arabic: "ŸÅŸéÿ±Ÿéÿßÿ¥Ÿéÿ©", french: "papillon" },
                { arabic: "ŸÜŸéÿ≠ŸíŸÑŸéÿ©", french: "abeille" },
                { arabic: "ŸÜŸéŸÖŸíŸÑŸéÿ©", french: "fourmi" }
            ],
            "Vocabulaire G√©n√©ral": [
                { arabic: "ÿ£Ÿèÿ∞ŸèŸÜ", french: "oreille" },
                { arabic: "ÿ•Ÿêÿ®Ÿíÿ±Ÿéÿ©", french: "aiguille" },
                { arabic: "ÿ•Ÿêÿ®Ÿíÿ±ŸêŸäŸÇ", french: "th√©i√®re" },
                { arabic: "ÿ®Ÿéÿßÿ®", french: "porte" },
                { arabic: "ÿ®Ÿéÿ≠Ÿíÿ±", french: "mer" },
                { arabic: "ÿ®Ÿéÿ∑ŸéŸëÿßŸÜŸêŸäŸéÿ©", french: "couverture" },
                { arabic: "ÿ®Ÿéÿ∑ŸêŸëŸäÿÆ", french: "past√®que" },
                { arabic: "ÿ®Ÿèÿ±Ÿíÿ¨", french: "tour" },
                { arabic: "ÿ®ŸéŸäŸíÿ™", french: "maison" },
                { arabic: "ÿ™ŸéŸÖŸíÿ±", french: "dattes" },
                { arabic: "ÿ™ŸèŸÅŸéŸëÿßÿ≠", french: "pomme" },
                { arabic: "ÿ™ŸèŸàÿ™", french: "m√ªres" },
                { arabic: "ÿ´ŸéŸÑŸéŸëÿßÿ¨Ÿéÿ©", french: "r√©frig√©rateur" },
                { arabic: "ÿ´Ÿèÿ±ŸéŸäŸéŸëÿß", french: "lustre" },
                { arabic: "ÿ´ŸèÿπŸíÿ®ŸéÿßŸÜ", french: "serpent" },
                { arabic: "ÿ´ŸéŸàŸíÿ®", french: "v√™tement/robe" },
                { arabic: "ÿ´ŸèŸàŸÖ", french: "ail" },
                { arabic: "ÿ´ŸêŸäŸéÿßÿ®", french: "v√™tements" },
                { arabic: "ÿ¨Ÿêÿ≥Ÿíÿ±", french: "pont" },
                { arabic: "ÿ¨Ÿèÿ®ŸíŸÜ", french: "fromage" },
                { arabic: "ÿ≠ŸéÿßŸÅŸêŸÑŸéÿ©", french: "bus" },
                { arabic: "ÿ≠ŸéŸÇŸêŸäÿ®Ÿéÿ©", french: "valise/sac" },
                { arabic: "ÿ≠ŸèŸàÿ™", french: "baleine" },
                { arabic: "ÿÆŸèÿ®Ÿíÿ≤", french: "pain" },
                { arabic: "ÿÆŸêŸäŸéÿßÿ±", french: "concombre" },
                { arabic: "ÿØŸéŸÅŸíÿ™Ÿéÿ±", french: "cahier" },
                { arabic: "ÿØŸêŸäŸÉ", french: "coq" },
                { arabic: "ÿ∞ŸéŸáŸéÿ®", french: "or" },
                { arabic: "ÿ∞Ÿêÿ±Ÿéÿßÿπ", french: "bras" },
                { arabic: "ÿ∞Ÿèÿ±Ÿéÿ©", french: "ma√Øs" },
                { arabic: "ÿ∞ŸéŸäŸíŸÑ", french: "queue" },
                { arabic: "ÿ±ŸéŸÜŸíÿ¨", french: "cuisini√®re" },
                { arabic: "ÿ±ŸèŸÖŸíÿ≠", french: "lance" },
                { arabic: "ÿ±Ÿèÿ≤Ÿë", french: "riz" },
                { arabic: "ÿ±ŸêŸäÿ¥Ÿéÿ©", french: "plume" },
                { arabic: "ÿ≤ŸéŸáŸíÿ±ŸêŸäŸéŸëÿ©", french: "vase de fleurs" },
                { arabic: "ÿ≤Ÿèÿ¨Ÿéÿßÿ¨Ÿéÿ©", french: "bouteille" },
                { arabic: "ÿ≤ŸéŸäŸíÿ™", french: "huile" },
                { arabic: "ÿ≤Ÿêÿ±Ÿë", french: "bouton" },
                { arabic: "ÿ≥Ÿéÿ®ŸèŸëŸàÿ±Ÿéÿ©", french: "tableau (noir)" },
                { arabic: "ÿ≥ŸéÿÆŸéŸëÿßŸÜ", french: "chauffe-eau" },
                { arabic: "ÿ≥Ÿéÿ±ŸêŸäÿ±", french: "lit" },
                { arabic: "ÿ≥ŸéŸÖŸéŸÉŸéÿ©", french: "poisson" },
                { arabic: "ÿ≥ŸéŸÖŸéŸëÿßÿπŸéÿ©", french: "casque audio" },
                { arabic: "ÿ≥ŸéŸäŸéŸëÿßÿ±Ÿéÿ©", french: "voiture" },
                { arabic: "ÿ≥ŸêŸàŸéÿßŸÉ", french: "siwak (b√¢ton √† dents)" },
                { arabic: "ÿ≥ŸèŸàŸÇ", french: "march√©" },
                { arabic: "ÿ¥Ÿéÿ¨Ÿéÿ±Ÿéÿ©", french: "arbre" },
                { arabic: "ÿ¥ŸéÿπŸíÿ±", french: "cheveux" },
                { arabic: "ÿ¥ŸéŸÖŸíÿπŸéÿ©", french: "bougie" },
                { arabic: "ÿ¥Ÿêÿ±Ÿéÿßÿπ", french: "voile (bateau)" },
                { arabic: "ÿ∂Ÿéÿ®Ÿë", french: "l√©zard" },
                { arabic: "ÿ∂Ÿéÿßÿ®Ÿêÿ∑", french: "officier" },
                { arabic: "ÿ∂Ÿêÿ±Ÿíÿ≥", french: "molaire/dent" },
                { arabic: "ÿ∂ŸèŸÅŸíÿØŸéÿπ", french: "grenouille" },
                { arabic: "ÿ∑ŸéÿßŸÑŸêÿ®", french: "√©tudiant" },
                { arabic: "ÿ∑Ÿéÿ®ŸêŸäÿ®", french: "m√©decin" },
                { arabic: "ÿ∑Ÿéÿ±ŸêŸäŸÇ", french: "route/chemin" },
                { arabic: "ÿ∑ŸéŸàŸíŸÇ", french: "collier/anneau" },
                { arabic: "ÿ∑ŸéŸäŸéŸëÿßÿ±", french: "pilote" },
                { arabic: "ÿ∑ŸêŸÅŸíŸÑ", french: "enfant" },
                { arabic: "ÿ∑ŸèŸàÿ®Ÿéÿ©", french: "brique" },
                { arabic: "ÿ∏Ÿéÿ±ŸíŸÅ", french: "enveloppe" },
                { arabic: "ÿ∏ŸêŸÑŸë", french: "ombre" },
                { arabic: "ÿ∏ŸèŸÅŸíÿ±", french: "ongle" },
                { arabic: "ÿπŸéŸäŸíŸÜ", french: "≈ìil" },
                { arabic: "ÿπŸêŸÜŸéÿ®", french: "raisins" },
                { arabic: "ÿ∫ŸéŸÖŸíÿØ", french: "fourreau/gaine" },
                { arabic: "ÿ∫ŸèÿµŸíŸÜ", french: "branche" },
                { arabic: "ŸÅŸéÿ£Ÿíÿ±", french: "souris" },
                { arabic: "ŸÅŸéÿØŸéŸëÿßÿ≠Ÿéÿ©", french: "tournevis" },
                { arabic: "ŸÅŸéÿ±ŸéÿßŸàŸíŸÑŸéÿ©", french: "fraise" },
                { arabic: "ŸÅŸéÿµŸíŸÑ", french: "classe" },
                { arabic: "ŸÅŸèŸÑŸíŸÅŸèŸÑ", french: "poivre/poivron" },
                { arabic: "ŸÅŸèŸàŸÑ", french: "f√®ves" },
                { arabic: "ŸÇŸéÿØŸéŸÖ", french: "pied" },
                { arabic: "ŸÇŸèŸÅŸíŸÑ", french: "cadenas" },
                { arabic: "ŸÇŸéŸÑŸéŸÖ", french: "stylo" },
                { arabic: "ŸÇŸéŸÑŸíÿ®", french: "c≈ìur" },
                { arabic: "ŸÉŸéÿπŸíÿ®Ÿéÿ©", french: "Kaaba" },
                { arabic: "ŸÉŸêÿ™Ÿéÿßÿ®", french: "livre" },
                { arabic: "ŸÉŸèŸÖŸéŸëÿ´Ÿíÿ±ŸéŸâ", french: "poire" },
                { arabic: "ŸÉŸèŸàÿ®", french: "verre/tasse" },
                { arabic: "ŸÑŸéÿ≠ŸíŸÖ", french: "viande" },
                { arabic: "ŸÑŸéŸäŸíŸÖŸèŸàŸÜ", french: "citron" },
                { arabic: "ŸÑŸêÿ≥ŸéÿßŸÜ", french: "langue" },
                { arabic: "ŸÑŸèŸàÿ®ŸêŸäŸéÿß", french: "haricots" },
                { arabic: "ŸÖŸéÿ±ŸêŸäÿ∂", french: "malade" },
                { arabic: "ŸÖŸéÿ≥Ÿíÿ¨ŸêÿØ", french: "mosqu√©e" },
                { arabic: "ŸÖŸêÿµŸíÿ®Ÿéÿßÿ≠", french: "lampe" },
                { arabic: "ŸÖŸèÿµŸíÿ≠ŸéŸÅ", french: "Coran" },
                { arabic: "ŸÖŸèÿπŸéŸÑŸêŸëŸÖ", french: "enseignant" },
                { arabic: "ŸÖŸèŸÉŸéŸäŸêŸëŸÅ", french: "climatiseur" },
                { arabic: "ŸÖŸéŸÉŸíÿ™Ÿéÿ®", french: "bureau" },
                { arabic: "ŸÖŸèŸÜŸíÿ¥Ÿéÿ©", french: "scie" },
                { arabic: "ŸÖŸèŸÜŸéÿ®ŸêŸëŸá", french: "r√©veil" },
                { arabic: "ŸÖŸèŸáŸéÿ±ŸêŸëÿ¨", french: "clown" },
                { arabic: "ŸÖŸêŸÅŸíÿ™Ÿéÿßÿ≠", french: "cl√©" },
                { arabic: "ŸÖŸêÿ≥ŸíŸÖŸéÿßÿ±", french: "clou/vis" },
                { arabic: "ŸÜŸéÿßŸÅŸêÿ∞Ÿéÿ©", french: "fen√™tre" },
                { arabic: "ŸÜŸéÿ≠ŸêŸäŸÅ", french: "maigre" },
                { arabic: "ŸÜŸéÿÆŸíŸÑ", french: "palmiers" },
                { arabic: "ŸÜŸêŸÇŸéÿßÿ®", french: "niqab" },
                { arabic: "ŸÜŸèÿ¨ŸèŸàŸÖ", french: "√©toiles" },
                { arabic: "ŸÜŸèŸÇŸèŸàÿØ", french: "argent/monnaie" },
                { arabic: "ŸáŸéÿßÿ™ŸêŸÅ", french: "t√©l√©phone" },
                { arabic: "ŸáŸéÿ±ŸéŸÖ", french: "pyramide" },
                { arabic: "ŸáŸêŸÑŸéÿßŸÑ", french: "croissant" },
                { arabic: "ŸáŸèÿØŸíŸáŸèÿØ", french: "huppe (oiseau)" },
                { arabic: "ŸàŸéÿ±ŸíÿØŸéÿ©", french: "rose" },
                { arabic: "ŸàŸêÿ≥ŸéÿßÿØŸéÿ©", french: "oreiller" },
                { arabic: "ŸäŸéÿØ", french: "main" },
                { arabic: "ŸäŸèŸàÿ≥ŸèŸÅŸêŸä", french: "mandarine" }
            ],
            "Verbes": [
                { arabic: "ŸäŸéÿ£ŸíŸÉŸèŸÑ", french: "il mange" },
                { arabic: "ŸäŸéÿ™Ÿéÿ≤ŸéŸÑŸéŸëŸÇ", french: "il glisse/fait du ski" },
                { arabic: "ŸäŸéÿ™Ÿéÿ≥ŸéŸÑŸéŸëŸÇ", french: "il grimpe/escalade" },
                { arabic: "ŸäŸéÿ™ŸéŸëÿµŸêŸÑ", french: "il appelle/contacte" },
                { arabic: "ŸäŸéÿ™ŸéŸàŸéÿ∂ŸéŸëÿ£", french: "il fait ses ablutions" },
                { arabic: "ŸäŸéÿ¨Ÿèÿ±ŸèŸë", french: "il tire/tra√Æne" },
                { arabic: "ŸäŸéÿ¨Ÿíÿ±ŸêŸä", french: "il court" },
                { arabic: "ŸäŸéÿ¨ŸíŸÑŸêÿ≥", french: "il s'assoit" },
                { arabic: "ŸäŸéÿ≠Ÿíÿ¨ŸèŸë", french: "il fait le p√®lerinage" },
                { arabic: "ŸäŸéÿ≠ŸíŸÅŸéÿ∏", french: "il m√©morise/garde" },
                { arabic: "ŸäŸéÿÆŸíÿ±Ÿèÿ¨", french: "il sort" },
                { arabic: "ŸäŸéÿØŸíÿÆŸèŸÑ", french: "il entre" },
                { arabic: "ŸäŸéÿØŸèŸÇŸèŸë", french: "il frappe/cogne" },
                { arabic: "ŸäŸéÿ∞ŸíŸáŸéÿ®", french: "il va/part" },
                { arabic: "ŸäŸéÿ¥ŸèŸÖŸèŸë", french: "il sent/renifle" },
                { arabic: "ŸäŸéÿµŸíÿπŸéÿØ", french: "il monte" },
                { arabic: "ŸäŸéÿπŸèÿ∂ŸèŸë", french: "il mord" },
                { arabic: "ŸäŸèÿ∫ŸéŸÑŸêŸëŸÇ", french: "il ferme" },
                { arabic: "ŸäŸéŸÅŸíÿ™Ÿéÿ≠", french: "il ouvre" },
                { arabic: "ŸäŸéŸÇŸíÿ±Ÿéÿ£", french: "il lit" },
                { arabic: "ŸäŸéŸÉŸíÿ™Ÿèÿ®", french: "il √©crit" },
                { arabic: "ŸäŸéŸÑŸíÿπŸéÿ®", french: "il joue" },
                { arabic: "ŸäŸéŸÖŸíÿ¥ŸêŸä", french: "il marche" },
                { arabic: "ŸäŸéŸÜŸéÿßŸÖ", french: "il dort" },
                { arabic: "ŸäŸéŸÜŸíŸÅŸèÿ∂Ÿè", french: "il secoue/√©poussette" },
                { arabic: "ŸäŸéŸÜŸíÿ≤ŸêŸÑ", french: "il descend" }
            ],
            "Nombres": [
                { arabic: "ÿµŸêŸÅŸíÿ±", french: "z√©ro (0)" },
                { arabic: "ŸàŸéÿßÿ≠ŸêÿØ", french: "un (1)" },
                { arabic: "ÿßÿ´ŸíŸÜŸéÿßŸÜ", french: "deux (2)" },
                { arabic: "ÿ´ŸéŸÑŸéÿßÿ´Ÿéÿ©", french: "trois (3)" },
                { arabic: "ÿ£Ÿéÿ±Ÿíÿ®ŸéÿπŸéÿ©", french: "quatre (4)" },
                { arabic: "ÿÆŸéŸÖŸíÿ≥Ÿéÿ©", french: "cinq (5)" },
                { arabic: "ÿ≥Ÿêÿ™ŸéŸëÿ©", french: "six (6)" },
                { arabic: "ÿ≥Ÿéÿ®ŸíÿπŸéÿ©", french: "sept (7)" },
                { arabic: "ÿ´ŸéŸÖŸéÿßŸÜŸêŸäŸéÿ©", french: "huit (8)" },
                { arabic: "ÿ™Ÿêÿ≥ŸíÿπŸéÿ©", french: "neuf (9)" },
                { arabic: "ÿπŸéÿ¥Ÿéÿ±Ÿéÿ©", french: "dix (10)" }
            ],
            "Jours de la Semaine": [
                { arabic: "ÿßŸÑÿ≥ŸéŸëÿ®Ÿíÿ™", french: "samedi" },
                { arabic: "ÿßŸÑŸíÿ£Ÿéÿ≠ŸéÿØ", french: "dimanche" },
                { arabic: "ÿßŸÑŸíÿ•Ÿêÿ´ŸíŸÜŸéŸäŸíŸÜ", french: "lundi" },
                { arabic: "ÿßŸÑÿ´ŸèŸëŸÑŸéÿßÿ´Ÿéÿßÿ°", french: "mardi" },
                { arabic: "ÿßŸÑŸíÿ£Ÿéÿ±Ÿíÿ®ŸêÿπŸéÿßÿ°", french: "mercredi" },
                { arabic: "ÿßŸÑŸíÿÆŸéŸÖŸêŸäÿ≥", french: "jeudi" },
                { arabic: "ÿßŸÑŸíÿ¨ŸèŸÖŸíÿπŸéÿ©", french: "vendredi" }
            ]
        };

        // Variables globales
        let currentTab = 0;
        let currentCategory = "Couleurs";
        let currentCardIndex = 0;
        let currentCards = [];
        let isFlipped = false;

        // Variables du quiz
        let quizCategory = "Tout";
        let quizMode = "qcm"; // "qcm" ou "texte"
        let quizQuestions = [];
        let currentQuestionIndex = 0;
        let correctCount = 0;
        let incorrectCount = 0;
        let answered = false;
        let remainingAttempts = 3;

        // Syst√®me de m√©moire
        const STORAGE_KEY = 'arabic_vocab_memory';
        
        function getVocabMemory() {
            const stored = localStorage.getItem(STORAGE_KEY);
            return stored ? JSON.parse(stored) : {};
        }

        function saveVocabMemory(memory) {
            localStorage.setItem(STORAGE_KEY, JSON.stringify(memory));
        }

        function updateWordStats(arabicWord, isCorrect) {
            const memory = getVocabMemory();
            
            if (!memory[arabicWord]) {
                memory[arabicWord] = {
                    correct: 0,
                    incorrect: 0,
                    consecutiveErrors: 0,
                    lastAttempt: Date.now()
                };
            }

            if (isCorrect) {
                memory[arabicWord].correct++;
                memory[arabicWord].consecutiveErrors = 0;
            } else {
                memory[arabicWord].incorrect++;
                memory[arabicWord].consecutiveErrors++;
            }
            
            memory[arabicWord].lastAttempt = Date.now();
            saveVocabMemory(memory);
        }

        function getWordDifficulty(arabicWord) {
            const memory = getVocabMemory();
            const stats = memory[arabicWord];
            
            if (!stats) return 'default';
            
            // Mots tr√®s difficiles : 4+ erreurs cons√©cutives
            if (stats.consecutiveErrors >= 4) return 'very-hard';
            
            // Mots difficiles : 2-3 erreurs cons√©cutives
            if (stats.consecutiveErrors >= 2) return 'hard';
            
            const total = stats.correct + stats.incorrect;
            if (total === 0) return 'default';
            
            const successRate = stats.correct / total;
            
            // Mots ma√Ætris√©s : plus de 70% de r√©ussite et au moins 3 tentatives
            if (successRate >= 0.7 && total >= 3) return 'mastered';
            
            // Mots en apprentissage : quelques tentatives avec moins de 70% de r√©ussite
            if (stats.incorrect > 0 && successRate < 0.7) return 'learning';
            
            return 'default';
        }

        function getDifficultyColor(difficulty) {
            const colors = {
                'very-hard': '#dc3545',
                'hard': '#fd7e14',
                'learning': '#ffc107',
                'mastered': '#28a745',
                'default': '#97bc62'
            };
            return colors[difficulty] || colors.default;
        }

        // Initialisation
        window.onload = function() {
            displayVocabulary();
            setupFlashcards();
            setupQuiz();
            displayMemoryStats();
        };

        // Gestion des onglets
        function switchTab(tabIndex) {
            const tabs = document.querySelectorAll('.tab');
            const contents = document.querySelectorAll('.tab-content');
            
            tabs.forEach((tab, index) => {
                if (index === tabIndex) {
                    tab.classList.add('active');
                } else {
                    tab.classList.remove('active');
                }
            });

            contents.forEach((content, index) => {
                if (index === tabIndex) {
                    content.classList.add('active');
                } else {
                    content.classList.remove('active');
                }
            });

            currentTab = tabIndex;

            if (tabIndex === 1) {
                loadCards(currentCategory);
            }
        }

        // Affichage du vocabulaire
        function displayVocabulary() {
            const container = document.getElementById('vocabulary-container');
            container.innerHTML = '';
            
            // Ajouter la l√©gende des couleurs
            addColorLegend();

            for (const [category, words] of Object.entries(vocabulary)) {
                const categoryDiv = document.createElement('div');
                categoryDiv.className = 'category';

                const titleDiv = document.createElement('div');
                titleDiv.className = 'category-title';
                titleDiv.textContent = category;
                categoryDiv.appendChild(titleDiv);

                const gridDiv = document.createElement('div');
                gridDiv.className = 'vocab-grid';

                words.forEach(word => {
                    const itemDiv = document.createElement('div');
                    itemDiv.className = 'vocab-item';
                    
                    // Appliquer la couleur selon la difficult√©
                    const difficulty = getWordDifficulty(word.arabic);
                    const color = getDifficultyColor(difficulty);
                    itemDiv.style.borderLeftColor = color;
                    itemDiv.style.borderLeftWidth = '4px';

                    const arabicDiv = document.createElement('div');
                    arabicDiv.className = 'arabic-text';
                    arabicDiv.textContent = word.arabic;

                    const frenchDiv = document.createElement('div');
                    frenchDiv.className = 'french-text';
                    frenchDiv.textContent = word.french;

                    itemDiv.appendChild(arabicDiv);
                    itemDiv.appendChild(frenchDiv);
                    gridDiv.appendChild(itemDiv);
                });

                categoryDiv.appendChild(gridDiv);
                container.appendChild(categoryDiv);
            }
            
            // Mettre √† jour les statistiques
            displayMemoryStats();
        }

        // Configuration des flashcards
        function setupFlashcards() {
            const container = document.getElementById('flashcard-categories');
            container.innerHTML = '';

            const allBtn = document.createElement('button');
            allBtn.className = 'category-btn';
            allBtn.textContent = 'üìö Tout';
            allBtn.onclick = () => selectCategory('Tout');
            container.appendChild(allBtn);

            for (const category of Object.keys(vocabulary)) {
                const btn = document.createElement('button');
                btn.className = 'category-btn';
                btn.textContent = category;
                btn.onclick = () => selectCategory(category);
                container.appendChild(btn);
            }
        }

        function selectCategory(category) {
            currentCategory = category;
            const buttons = document.querySelectorAll('#flashcard-categories .category-btn');
            buttons.forEach(btn => {
                if (btn.textContent === category || (category === 'Tout' && btn.textContent === 'üìö Tout')) {
                    btn.classList.add('active');
                } else {
                    btn.classList.remove('active');
                }
            });
            loadCards(category);
        }

        function loadCards(category) {
            currentCards = [];
            
            if (category === 'Tout') {
                for (const words of Object.values(vocabulary)) {
                    currentCards = currentCards.concat(words);
                }
            } else {
                currentCards = vocabulary[category] || [];
            }

            displayAllCards();
        }

        function displayAllCards() {
            const container = document.getElementById('flashcard-container');
            container.innerHTML = '';

            // Mettre √† jour le compteur
            const countElement = document.getElementById('card-count');
            if (countElement) {
                countElement.textContent = `${currentCards.length} carte${currentCards.length > 1 ? 's' : ''}`;
            }

            if (currentCards.length === 0) {
                container.innerHTML = '<p style="text-align: center; color: #666; padding: 40px;">Aucune carte disponible</p>';
                return;
            }

            currentCards.forEach((card, index) => {
                const flashcardDiv = document.createElement('div');
                flashcardDiv.className = 'flashcard';
                flashcardDiv.id = `flashcard-${index}`;
                
                flashcardDiv.innerHTML = `
                    <div class="flashcard-inner">
                        <div class="flashcard-front">${card.french}</div>
                        <div class="flashcard-back">${card.arabic}</div>
                    </div>
                `;
                
                flashcardDiv.addEventListener('click', function() {
                    this.classList.toggle('flipped');
                });
                
                container.appendChild(flashcardDiv);
            });
        }

        function flipAllCards() {
            const allCards = document.querySelectorAll('.flashcard');
            allCards.forEach(card => {
                card.classList.add('flipped');
            });
        }

        function resetAllCards() {
            const allCards = document.querySelectorAll('.flashcard');
            allCards.forEach(card => {
                card.classList.remove('flipped');
            });
        }

        // Configuration du quiz
        function setupQuiz() {
            const container = document.getElementById('quiz-categories');
            container.innerHTML = '';

            const allBtn = document.createElement('button');
            allBtn.className = 'category-btn active';
            allBtn.textContent = 'üìö Tout le vocabulaire';
            allBtn.onclick = () => selectQuizCategory('Tout');
            container.appendChild(allBtn);

            for (const category of Object.keys(vocabulary)) {
                const btn = document.createElement('button');
                btn.className = 'category-btn';
                btn.textContent = category;
                btn.onclick = () => selectQuizCategory(category);
                container.appendChild(btn);
            }
        }

        function selectQuizCategory(category) {
            quizCategory = category;
            const buttons = document.querySelectorAll('#quiz-categories .category-btn');
            buttons.forEach(btn => {
                if (btn.textContent === category || (category === 'Tout' && btn.textContent === 'üìö Tout le vocabulaire')) {
                    btn.classList.add('active');
                } else {
                    btn.classList.remove('active');
                }
            });
        }

        function selectQuizMode(mode) {
            quizMode = mode;
            const buttons = document.querySelectorAll('#quiz-mode-buttons .category-btn');
            buttons.forEach(btn => {
                btn.classList.remove('active');
            });
            event.target.classList.add('active');
        }

        function startQuiz() {
            // Pr√©parer les questions
            quizQuestions = [];
            
            if (quizCategory === 'Tout') {
                for (const words of Object.values(vocabulary)) {
                    quizQuestions = quizQuestions.concat(words);
                }
            } else {
                quizQuestions = vocabulary[quizCategory] || [];
            }

            // M√©langer les questions
            quizQuestions = shuffleArray([...quizQuestions]);

            currentQuestionIndex = 0;
            correctCount = 0;
            incorrectCount = 0;

            document.getElementById('quiz-setup').style.display = 'none';
            document.getElementById('quiz-game').style.display = 'block';
            document.getElementById('quiz-results').style.display = 'none';

            showQuestion();
        }

        function showQuestion() {
            if (currentQuestionIndex >= quizQuestions.length) {
                showResults();
                return;
            }

            answered = false;
            remainingAttempts = 3;
            const question = quizQuestions[currentQuestionIndex];

            // Mise √† jour de la progression
            const progress = ((currentQuestionIndex) / quizQuestions.length) * 100;
            document.getElementById('progress-fill').style.width = progress + '%';
            document.getElementById('progress-fill').textContent = Math.round(progress) + '%';

            document.getElementById('current-question').textContent = currentQuestionIndex + 1;
            document.getElementById('total-questions').textContent = quizQuestions.length;
            document.getElementById('correct-answers').textContent = correctCount;
            document.getElementById('incorrect-answers').textContent = incorrectCount;

            // Afficher le mode appropri√©
            if (quizMode === 'qcm') {
                document.getElementById('qcm-mode').style.display = 'block';
                document.getElementById('text-mode').style.display = 'none';
                
                // Question
                document.getElementById('question-text').textContent = question.french;
                document.getElementById('question-hint').textContent = 'Quelle est la traduction en arabe ?';

                // G√©n√©rer les options de r√©ponse
                const options = generateOptions(question);
                const optionsContainer = document.getElementById('answer-options');
                optionsContainer.innerHTML = '';

                options.forEach((option, index) => {
                    const btn = document.createElement('button');
                    btn.className = 'answer-btn';
                    btn.textContent = option.arabic;
                    btn.onclick = () => checkAnswer(option, question, btn);
                    optionsContainer.appendChild(btn);
                });
            } else {
                // Mode texte
                document.getElementById('qcm-mode').style.display = 'none';
                document.getElementById('text-mode').style.display = 'block';
                
                // Question
                document.getElementById('question-text').textContent = question.arabic;
                document.getElementById('question-hint').textContent = '√âcrivez la traduction en fran√ßais';

                // Reset input
                const input = document.getElementById('text-answer-input');
                input.value = '';
                input.className = 'text-input';
                input.disabled = false;
                input.focus();
                
                // Reset feedback
                document.getElementById('feedback-container').innerHTML = '';
                
                // Reset attempts display
                document.getElementById('remaining-attempts').textContent = '3';
                
                // Enable submit button
                document.getElementById('submit-answer-btn').disabled = false;
                
                // Permettre la validation avec Enter
                input.onkeypress = function(e) {
                    if (e.key === 'Enter' && !answered) {
                        checkTextAnswer();
                    }
                };
            }

            document.getElementById('next-question-btn').style.display = 'none';
        }

        function checkTextAnswer() {
            if (answered) return;

            const input = document.getElementById('text-answer-input');
            const userAnswer = input.value.trim();
            const question = quizQuestions[currentQuestionIndex];
            const correctAnswer = question.french;

            // Normaliser les r√©ponses pour la comparaison
            const normalizedUser = normalizeText(userAnswer);
            const normalizedCorrect = normalizeText(correctAnswer);

            const feedbackContainer = document.getElementById('feedback-container');
            
            if (normalizedUser === normalizedCorrect) {
                // R√©ponse correcte
                answered = true;
                correctCount++;
                
                input.className = 'text-input correct';
                input.disabled = true;
                
                feedbackContainer.innerHTML = `
                    <div class="feedback-message success">
                        ‚úì Correct ! La r√©ponse √©tait bien : <strong>${correctAnswer}</strong>
                    </div>
                `;
                
                document.getElementById('submit-answer-btn').disabled = true;
                document.getElementById('next-question-btn').style.display = 'block';
                
                // Enregistrer les statistiques
                updateWordStats(question.arabic, true);
                displayVocabulary();
                
                document.getElementById('correct-answers').textContent = correctCount;
            } else {
                // R√©ponse incorrecte
                remainingAttempts--;
                document.getElementById('remaining-attempts').textContent = remainingAttempts;
                
                if (remainingAttempts > 0) {
                    // Il reste des tentatives
                    input.className = 'text-input incorrect';
                    
                    feedbackContainer.innerHTML = `
                        <div class="feedback-message error">
                            ‚úó Incorrect. Il vous reste ${remainingAttempts} tentative${remainingAttempts > 1 ? 's' : ''}. R√©essayez !
                        </div>
                    `;
                    
                    // S√©lectionner le texte pour faciliter la correction
                    input.select();
                } else {
                    // Plus de tentatives
                    answered = true;
                    incorrectCount++;
                    
                    input.className = 'text-input incorrect';
                    input.disabled = true;
                    
                    feedbackContainer.innerHTML = `
                        <div class="feedback-message error">
                            ‚úó Aucune tentative restante. La bonne r√©ponse √©tait : <strong>${correctAnswer}</strong>
                        </div>
                    `;
                    
                    document.getElementById('submit-answer-btn').disabled = true;
                    document.getElementById('next-question-btn').style.display = 'block';
                    
                    // Enregistrer les statistiques
                    updateWordStats(question.arabic, false);
                    displayVocabulary();
                    
                    document.getElementById('incorrect-answers').textContent = incorrectCount;
                }
            }
        }

        function normalizeText(text) {
            // Normaliser le texte : minuscules, sans accents, sans espaces multiples, sans ponctuation
            return text
                .toLowerCase()
                .normalize("NFD").replace(/[\u0300-\u036f]/g, "") // Enlever les accents
                .replace(/[^\w\s]/g, '') // Enlever la ponctuation
                .replace(/\s+/g, ' ') // Normaliser les espaces
                .trim();
        }

        function generateOptions(correctAnswer) {
            const allWords = [];
            for (const words of Object.values(vocabulary)) {
                allWords.push(...words);
            }

            const options = [correctAnswer];
            const usedArabic = new Set([correctAnswer.arabic]);

            while (options.length < 4) {
                const randomWord = allWords[Math.floor(Math.random() * allWords.length)];
                if (!usedArabic.has(randomWord.arabic)) {
                    options.push(randomWord);
                    usedArabic.add(randomWord.arabic);
                }
            }

            return shuffleArray(options);
        }

        function checkAnswer(selected, correct, btn) {
            if (answered) return;
            answered = true;

            const buttons = document.querySelectorAll('.answer-btn');
            buttons.forEach(b => b.style.pointerEvents = 'none');

            const isCorrect = selected.arabic === correct.arabic;

            if (isCorrect) {
                btn.classList.add('correct');
                correctCount++;
            } else {
                btn.classList.add('incorrect');
                // Montrer la bonne r√©ponse
                buttons.forEach(b => {
                    if (b.textContent === correct.arabic) {
                        b.classList.add('correct');
                    }
                });
                incorrectCount++;
            }

            // Enregistrer les statistiques
            updateWordStats(correct.arabic, isCorrect);
            
            // CORRECTION: Toujours rafra√Æchir l'affichage du vocabulaire
            displayVocabulary();

            document.getElementById('correct-answers').textContent = correctCount;
            document.getElementById('incorrect-answers').textContent = incorrectCount;
            document.getElementById('next-question-btn').style.display = 'block';
        }

        function nextQuestion() {
            currentQuestionIndex++;
            showQuestion();
        }

        function showResults() {
            document.getElementById('quiz-game').style.display = 'none';
            document.getElementById('quiz-results').style.display = 'block';

            const percentage = Math.round((correctCount / quizQuestions.length) * 100);
            document.getElementById('final-score').textContent = `${correctCount} / ${quizQuestions.length} (${percentage}%)`;

            let message = '';
            if (percentage === 100) {
                message = 'üéâ Parfait ! Vous ma√Ætrisez ce vocabulaire !';
            } else if (percentage >= 80) {
                message = 'üëè Excellent travail ! Continuez comme √ßa !';
            } else if (percentage >= 60) {
                message = 'üëç Bon travail ! Encore un peu de pratique et ce sera parfait !';
            } else {
                message = 'üí™ Continuez √† pratiquer ! Vous progresserez rapidement !';
            }

            document.getElementById('results-message').textContent = message;
        }

        function restartQuiz() {
            document.getElementById('quiz-setup').style.display = 'block';
            document.getElementById('quiz-game').style.display = 'none';
            document.getElementById('quiz-results').style.display = 'none';
        }

        // Fonction utilitaire pour m√©langer un tableau
        function shuffleArray(array) {
            const newArray = [...array];
            for (let i = newArray.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [newArray[i], newArray[j]] = [newArray[j], newArray[i]];
            }
            return newArray;
        }

        function displayMemoryStats() {
            const memory = getVocabMemory();
            const totalWords = Object.keys(memory).length;
            
            let veryHard = 0, hard = 0, learning = 0, mastered = 0;
            
            for (const word in memory) {
                const diff = getWordDifficulty(word);
                if (diff === 'very-hard') veryHard++;
                else if (diff === 'hard') hard++;
                else if (diff === 'learning') learning++;
                else if (diff === 'mastered') mastered++;
            }

            const statsDiv = document.getElementById('memory-stats');
            if (totalWords > 0) {
                statsDiv.innerHTML = `
                    <strong>Progression :</strong> 
                    <span style="color: #28a745;">‚úì ${mastered} ma√Ætris√©s</span> | 
                    <span style="color: #ffc107;">‚ö° ${learning} en cours</span> | 
                    <span style="color: #fd7e14;">‚ö† ${hard} difficiles</span> | 
                    <span style="color: #dc3545;">‚úó ${veryHard} √† revoir</span>
                `;
            }
        }

        function addColorLegend() {
            const container = document.getElementById('vocabulary-container');
            
            const legendDiv = document.createElement('div');
            legendDiv.style.cssText = `
                background: #fafaf8;
                padding: 20px;
                border-radius: 2px;
                margin-bottom: 30px;
                border: 1px solid #e0e0dc;
                text-align: center;
            `;
            
            legendDiv.innerHTML = `
                <h3 style="color: #2c5f2d; margin-bottom: 15px; font-size: 1.2em;">üìä L√©gende des couleurs</h3>
                <div style="display: flex; justify-content: center; gap: 20px; flex-wrap: wrap; font-size: 0.95em;">
                    <div><span style="display: inline-block; width: 20px; height: 20px; background: #dc3545; vertical-align: middle; margin-right: 5px;"></span> √Ä revoir (4+ erreurs)</div>
                    <div><span style="display: inline-block; width: 20px; height: 20px; background: #fd7e14; vertical-align: middle; margin-right: 5px;"></span> Difficile (2-3 erreurs)</div>
                    <div><span style="display: inline-block; width: 20px; height: 20px; background: #ffc107; vertical-align: middle; margin-right: 5px;"></span> En apprentissage</div>
                    <div><span style="display: inline-block; width: 20px; height: 20px; background: #28a745; vertical-align: middle; margin-right: 5px;"></span> Ma√Ætris√© (70%+ r√©ussite)</div>
                    <div><span style="display: inline-block; width: 20px; height: 20px; background: #97bc62; vertical-align: middle; margin-right: 5px;"></span> Non test√©</div>
                </div>
            `;
            
            container.insertBefore(legendDiv, container.firstChild);
        }

        function resetMemory() {
            if (confirm('‚ö†Ô∏è √ätes-vous s√ªr de vouloir r√©initialiser toutes vos statistiques d\'apprentissage ?')) {
                localStorage.removeItem(STORAGE_KEY);
                displayVocabulary();
                displayMemoryStats();
                alert('‚úÖ Statistiques r√©initialis√©es avec succ√®s !');
            }
        }
    </script>
</body>
</html>
