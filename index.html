<!DOCTYPE html>
<html lang="fr" dir="ltr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Apprentissage du Vocabulaire Arabe</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Georgia', 'Times New Roman', serif;
            background: #f5f5f0;
            min-height: 100vh;
            padding: 20px;
            color: #2c3e50;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            border-radius: 2px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.08);
            overflow: hidden;
            border-top: 5px solid #2c5f2d;
        }

        .header {
            background: linear-gradient(135deg, #2c5f2d 0%, #97bc62 100%);
            color: white;
            padding: 40px 30px;
            text-align: center;
            border-bottom: 3px solid #1a3a1b;
        }

        .header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
            font-weight: 600;
            letter-spacing: 1px;
        }

        .header p {
            font-size: 1.1em;
            opacity: 0.95;
            font-family: 'Segoe UI', sans-serif;
        }

        .tabs {
            display: flex;
            background: #fafaf8;
            border-bottom: 2px solid #d4d4d0;
            overflow-x: auto;
        }

        .tab {
            flex: 1;
            padding: 18px 20px;
            text-align: center;
            cursor: pointer;
            font-size: 1.05em;
            font-weight: 500;
            transition: all 0.3s;
            border: none;
            background: transparent;
            font-family: 'Segoe UI', sans-serif;
            color: #555;
            white-space: nowrap;
            min-width: 150px;
        }

        .tab:hover {
            background: #f0f0ec;
            color: #2c5f2d;
        }

        .tab.active {
            background: white;
            color: #2c5f2d;
            border-bottom: 3px solid #2c5f2d;
            font-weight: 600;
        }

        .content {
            padding: 35px;
            background: #ffffff;
        }

        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
        }

        /* Vocabulaire Tab */
        .category {
            margin-bottom: 45px;
            background: #fafaf8;
            padding: 25px;
            border-radius: 2px;
            border-left: 4px solid #2c5f2d;
        }

        .category.custom-category {
            border-left-color: #e67e22;
            background: #fef5e7;
        }

        .category-title {
            font-size: 1.8em;
            color: #2c5f2d;
            margin-bottom: 25px;
            padding-bottom: 12px;
            border-bottom: 2px solid #97bc62;
            font-family: 'Georgia', serif;
            font-weight: 600;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .custom-category .category-title {
            color: #e67e22;
            border-bottom-color: #e67e22;
        }

        .category-badge {
            font-size: 0.5em;
            background: #e67e22;
            color: white;
            padding: 5px 12px;
            border-radius: 15px;
            font-weight: 500;
        }

        .vocab-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 18px;
            margin-bottom: 20px;
        }

        .vocab-item {
            background: white;
            padding: 18px;
            border-radius: 2px;
            border: 1px solid #e0e0dc;
            border-left: 4px solid #97bc62;
            transition: all 0.2s;
        }

        .vocab-item:hover {
            box-shadow: 0 3px 12px rgba(0,0,0,0.08);
            transform: translateY(-2px);
        }

        .arabic-text {
            font-size: 1.5em;
            font-weight: 600;
            color: #1a3a1b;
            margin-bottom: 8px;
            direction: rtl;
            font-family: 'Arial', sans-serif;
        }

        .french-text {
            color: #666;
            font-size: 1.05em;
            font-family: 'Segoe UI', sans-serif;
        }

        /* Custom Words Tab */
        .custom-words-container {
            max-width: 800px;
            margin: 0 auto;
        }

        .add-word-form {
            background: #fafaf8;
            padding: 30px;
            border-radius: 2px;
            margin-bottom: 40px;
            border: 2px solid #2c5f2d;
        }

        .add-word-form h2 {
            color: #2c5f2d;
            margin-bottom: 25px;
            font-size: 1.8em;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: #2c5f2d;
            font-family: 'Segoe UI', sans-serif;
        }

        .form-group input,
        .form-group select {
            width: 100%;
            padding: 12px;
            border: 2px solid #d4d4d0;
            border-radius: 2px;
            font-size: 1em;
            font-family: 'Segoe UI', sans-serif;
            transition: all 0.3s;
        }

        .form-group input:focus,
        .form-group select:focus {
            outline: none;
            border-color: #2c5f2d;
            box-shadow: 0 0 5px rgba(44, 95, 45, 0.2);
        }

        .form-group input[dir="rtl"] {
            font-family: 'Arial', sans-serif;
        }

        .form-actions {
            display: flex;
            gap: 12px;
            flex-wrap: wrap;
        }

        .btn {
            padding: 12px 28px;
            border: none;
            border-radius: 2px;
            font-size: 1em;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            font-family: 'Segoe UI', sans-serif;
        }

        .btn-primary {
            background: #2c5f2d;
            color: white;
        }

        .btn-primary:hover {
            background: #1a3a1b;
        }

        .btn-secondary {
            background: #97bc62;
            color: white;
        }

        .btn-secondary:hover {
            background: #7a9d4f;
        }

        .btn-danger {
            background: #dc3545;
            color: white;
        }

        .btn-danger:hover {
            background: #c0392b;
        }

        .btn-small {
            padding: 6px 14px;
            font-size: 0.85em;
        }

        .custom-words-list {
            background: #fafaf8;
            padding: 25px;
            border-radius: 2px;
            border: 1px solid #e0e0dc;
        }

        .custom-words-list h3 {
            color: #2c5f2d;
            margin-bottom: 20px;
            font-size: 1.5em;
        }

        .custom-word-item {
            background: white;
            padding: 15px;
            margin-bottom: 12px;
            border-radius: 2px;
            border-left: 4px solid #e67e22;
            display: flex;
            justify-content: space-between;
            align-items: center;
            transition: all 0.2s;
        }

        .custom-word-item:hover {
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }

        .custom-word-content {
            flex: 1;
        }

        .custom-word-arabic {
            font-size: 1.3em;
            font-weight: 600;
            color: #1a3a1b;
            direction: rtl;
            font-family: 'Arial', sans-serif;
            margin-bottom: 5px;
        }

        .custom-word-french {
            color: #666;
            font-size: 1em;
            margin-bottom: 5px;
        }

        .custom-word-category {
            font-size: 0.85em;
            color: #e67e22;
            font-weight: 600;
        }

        .custom-word-actions {
            display: flex;
            gap: 8px;
        }

        .empty-state {
            text-align: center;
            padding: 60px 20px;
            color: #999;
        }

        .empty-state-icon {
            font-size: 4em;
            margin-bottom: 20px;
            opacity: 0.5;
        }

        .empty-state-text {
            font-size: 1.2em;
        }

        .category-manager {
            background: #fafaf8;
            padding: 20px;
            border-radius: 2px;
            margin-bottom: 30px;
            border: 1px solid #e0e0dc;
        }

        .category-manager h3 {
            color: #2c5f2d;
            margin-bottom: 15px;
            font-size: 1.3em;
        }

        .category-input-group {
            display: flex;
            gap: 10px;
            margin-bottom: 15px;
        }

        .category-input-group input {
            flex: 1;
            padding: 10px;
            border: 2px solid #d4d4d0;
            border-radius: 2px;
            font-size: 1em;
        }

        .custom-categories-list {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin-top: 15px;
        }

        .category-chip {
            background: #e67e22;
            color: white;
            padding: 8px 15px;
            border-radius: 20px;
            font-size: 0.9em;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .category-chip button {
            background: rgba(255,255,255,0.3);
            border: none;
            color: white;
            width: 20px;
            height: 20px;
            border-radius: 50%;
            cursor: pointer;
            font-size: 0.8em;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.2s;
        }

        .category-chip button:hover {
            background: rgba(255,255,255,0.5);
        }

        .export-import-section {
            background: #fafaf8;
            padding: 20px;
            border-radius: 2px;
            margin-top: 30px;
            border: 1px solid #e0e0dc;
        }

        .export-import-section h3 {
            color: #2c5f2d;
            margin-bottom: 15px;
            font-size: 1.3em;
        }

        .export-import-actions {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
        }

        .info-box {
            background: #d1ecf1;
            border: 1px solid #bee5eb;
            color: #0c5460;
            padding: 15px;
            border-radius: 2px;
            margin-bottom: 20px;
        }

        .info-box strong {
            display: block;
            margin-bottom: 5px;
        }

        /* Flashcards Tab */
        .flashcard-controls {
            display: flex;
            gap: 12px;
            margin-bottom: 35px;
            flex-wrap: wrap;
            padding: 20px;
            background: #fafaf8;
            border-radius: 2px;
        }

        .category-btn {
            padding: 11px 22px;
            border: 2px solid #2c5f2d;
            background: white;
            color: #2c5f2d;
            border-radius: 2px;
            cursor: pointer;
            font-size: 0.95em;
            font-weight: 500;
            transition: all 0.3s;
            font-family: 'Segoe UI', sans-serif;
        }

        .category-btn.custom {
            border-color: #e67e22;
            color: #e67e22;
        }

        .category-btn:hover {
            background: #2c5f2d;
            color: white;
        }

        .category-btn.custom:hover {
            background: #e67e22;
            color: white;
        }

        .category-btn.active {
            background: #2c5f2d;
            color: white;
            font-weight: 600;
        }

        .category-btn.custom.active {
            background: #e67e22;
        }

        .flashcard-container {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 25px;
            padding: 10px;
        }

        .flashcard {
            width: 100%;
            height: 250px;
            perspective: 1000px;
            cursor: pointer;
        }

        .flashcard-inner {
            position: relative;
            width: 100%;
            height: 100%;
            transition: transform 0.6s;
            transform-style: preserve-3d;
        }

        .flashcard.flipped .flashcard-inner {
            transform: rotateY(180deg);
        }

        .flashcard-front, .flashcard-back {
            position: absolute;
            width: 100%;
            height: 100%;
            backface-visibility: hidden;
            display: flex;
            justify-content: center;
            align-items: center;
            border-radius: 2px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.15);
            padding: 25px;
            font-size: 1.5em;
            font-weight: 600;
            border: 3px solid #e0e0dc;
            text-align: center;
        }

        .flashcard-front {
            background: white;
            color: #2c5f2d;
            font-family: 'Segoe UI', sans-serif;
        }

        .flashcard-back {
            background: linear-gradient(135deg, #2c5f2d 0%, #4a7c59 100%);
            color: white;
            transform: rotateY(180deg);
            direction: rtl;
            font-family: 'Arial', sans-serif;
        }

        .flip-control-btn {
            padding: 12px 30px;
            border: none;
            border-radius: 2px;
            cursor: pointer;
            font-size: 1em;
            font-weight: 500;
            margin: 0 5px;
            transition: all 0.3s;
            font-family: 'Segoe UI', sans-serif;
        }

        .flip-control-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
        }

        .flip-control-btn.primary {
            background: #2c5f2d;
            color: white;
        }

        .flip-control-btn.primary:hover {
            background: #1a3a1b;
        }

        .flip-control-btn.secondary {
            background: #97bc62;
            color: white;
        }

        .flip-control-btn.secondary:hover {
            background: #7a9d4f;
        }

        /* Quiz Tab */
        .quiz-setup {
            text-align: center;
        }

        .quiz-setup h2 {
            color: #2c5f2d;
            margin-bottom: 35px;
            font-size: 2.2em;
            font-weight: 600;
        }

        .quiz-options {
            display: flex;
            flex-direction: column;
            gap: 25px;
            max-width: 700px;
            margin: 0 auto;
        }

        .quiz-option-group {
            background: #fafaf8;
            padding: 28px;
            border-radius: 2px;
            border: 1px solid #e0e0dc;
        }

        .quiz-option-group h3 {
            color: #2c5f2d;
            margin-bottom: 18px;
            font-size: 1.3em;
            font-weight: 600;
        }

        .quiz-buttons {
            display: flex;
            flex-wrap: wrap;
            gap: 12px;
            justify-content: center;
        }

        .start-quiz-btn {
            padding: 16px 40px;
            background: #2c5f2d;
            color: white;
            border: none;
            border-radius: 2px;
            font-size: 1.2em;
            font-weight: 600;
            cursor: pointer;
            margin-top: 35px;
            transition: all 0.3s;
            font-family: 'Segoe UI', sans-serif;
        }

        .start-quiz-btn:hover {
            background: #1a3a1b;
            box-shadow: 0 4px 12px rgba(44, 95, 45, 0.3);
        }

        .quiz-game {
            max-width: 850px;
            margin: 0 auto;
            position: relative;
            padding-bottom: 80px;
        }

        .quiz-progress {
            background: #fafaf8;
            padding: 25px;
            border-radius: 2px;
            margin-bottom: 35px;
            border: 1px solid #e0e0dc;
        }

        .progress-bar {
            width: 100%;
            height: 32px;
            background: #e8e8e4;
            border-radius: 2px;
            overflow: hidden;
            margin-bottom: 18px;
            border: 1px solid #d4d4d0;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #2c5f2d 0%, #4a7c59 100%);
            transition: width 0.4s;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: 600;
            font-family: 'Segoe UI', sans-serif;
        }

        .quiz-stats {
            display: flex;
            justify-content: space-around;
            font-size: 1.05em;
            color: #444;
            font-family: 'Segoe UI', sans-serif;
        }

        .stat {
            font-weight: 500;
        }

        .stat-value {
            color: #2c5f2d;
            font-size: 1.35em;
            font-weight: 700;
        }

        .question-card {
            background: linear-gradient(135deg, #2c5f2d 0%, #4a7c59 100%);
            color: white;
            padding: 35px;
            border-radius: 2px;
            text-align: center;
            margin-bottom: 25px;
            border: 3px solid #1a3a1b;
        }

        .question-text {
            font-size: 2.3em;
            font-weight: 600;
            margin-bottom: 12px;
            font-family: 'Segoe UI', sans-serif;
        }

        .question-hint {
            font-size: 1.15em;
            opacity: 0.92;
            font-family: 'Segoe UI', sans-serif;
        }

        .answer-options {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 16px;
        }

        .answer-btn {
            padding: 28px;
            background: white;
            border: 2px solid #d4d4d0;
            border-radius: 2px;
            font-size: 1.3em;
            cursor: pointer;
            transition: all 0.3s;
            font-weight: 600;
            color: #2c3e50;
            font-family: 'Arial', sans-serif;
        }

        .answer-btn:hover {
            border-color: #2c5f2d;
            background: #fafaf8;
        }

        .answer-btn.correct {
            background: #27ae60;
            color: white;
            border-color: #27ae60;
        }

        .answer-btn.incorrect {
            background: #c0392b;
            color: white;
            border-color: #c0392b;
        }

        .text-answer-container {
            max-width: 600px;
            margin: 0 auto;
        }

        .text-input {
            width: 100%;
            padding: 20px;
            font-size: 1.3em;
            border: 3px solid #d4d4d0;
            border-radius: 2px;
            text-align: center;
            font-family: 'Segoe UI', sans-serif;
            margin-bottom: 20px;
            transition: all 0.3s;
        }

        .text-input:focus {
            outline: none;
            border-color: #2c5f2d;
            box-shadow: 0 0 10px rgba(44, 95, 45, 0.2);
        }

        .text-input.correct {
            border-color: #27ae60;
            background: #d4edda;
        }

        .text-input.incorrect {
            border-color: #c0392b;
            background: #f8d7da;
        }

        .submit-answer-btn {
            padding: 16px 40px;
            background: #2c5f2d;
            color: white;
            border: none;
            border-radius: 2px;
            font-size: 1.1em;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            font-family: 'Segoe UI', sans-serif;
        }

        .submit-answer-btn:hover {
            background: #1a3a1b;
        }

        .submit-answer-btn:disabled {
            background: #ccc;
            cursor: not-allowed;
        }

        .attempts-display {
            font-size: 1.1em;
            color: #555;
            margin: 15px 0;
            font-weight: 500;
        }

        .attempts-display .remaining {
            color: #2c5f2d;
            font-weight: 700;
        }

        .feedback-message {
            padding: 15px;
            border-radius: 2px;
            margin: 15px 0;
            font-size: 1.05em;
            font-weight: 500;
        }

        .feedback-message.error {
            background: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }

        .feedback-message.success {
            background: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }

        .feedback-message.info {
            background: #d1ecf1;
            color: #0c5460;
            border: 1px solid #bee5eb;
        }

        .next-btn-container {
            position: sticky;
            bottom: 0;
            background: white;
            padding: 15px 0;
            margin-top: 20px;
            border-top: 2px solid #e0e0dc;
            z-index: 100;
            box-shadow: 0 -2px 10px rgba(0,0,0,0.08);
            text-align: center;
        }

        .next-question-btn {
            padding: 14px 38px;
            background: #2c5f2d;
            color: white;
            border: none;
            border-radius: 2px;
            font-size: 1.1em;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            font-family: 'Segoe UI', sans-serif;
        }

        .next-question-btn:hover {
            background: #1a3a1b;
            transform: scale(1.05);
        }

        .quiz-results {
            text-align: center;
            padding: 50px;
        }

        .results-title {
            font-size: 2.5em;
            color: #2c5f2d;
            margin-bottom: 35px;
            font-weight: 600;
        }

        .results-score {
            font-size: 4.5em;
            font-weight: 700;
            color: #2c5f2d;
            margin-bottom: 25px;
            font-family: 'Segoe UI', sans-serif;
        }

        .results-message {
            font-size: 1.4em;
            color: #555;
            margin-bottom: 35px;
            font-family: 'Segoe UI', sans-serif;
        }

        .restart-btn {
            padding: 16px 40px;
            background: #2c5f2d;
            color: white;
            border: none;
            border-radius: 2px;
            font-size: 1.2em;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            font-family: 'Segoe UI', sans-serif;
        }

        .restart-btn:hover {
            background: #1a3a1b;
            box-shadow: 0 4px 12px rgba(44, 95, 45, 0.3);
        }

        @media (max-width: 768px) {
            .flashcard-container {
                grid-template-columns: 1fr;
            }

            .flashcard {
                height: 200px;
            }

            .answer-options {
                grid-template-columns: 1fr;
            }

            .vocab-grid {
                grid-template-columns: 1fr;
            }

            .header h1 {
                font-size: 2em;
            }

            .content {
                padding: 20px;
            }

            .question-card {
                padding: 25px;
            }

            .question-text {
                font-size: 1.8em;
            }

            .tabs {
                flex-wrap: nowrap;
                overflow-x: auto;
            }

            .tab {
                min-width: 120px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>ğŸ“š Apprentissage du Vocabulaire Arabe</h1>
            <p>Apprenez l'arabe avec des fiches, des cartes mentales et des quiz interactifs</p>
            <div id="memory-stats" style="margin-top: 20px; font-size: 0.95em; opacity: 0.9;"></div>
        </div>

        <div class="tabs">
            <button class="tab active" onclick="switchTab(0)">ğŸ“– Vocabulaire</button>
            <button class="tab" onclick="switchTab(1)">â• Mes Mots</button>
            <button class="tab" onclick="switchTab(2)">ğŸ´ Cartes Mentales</button>
            <button class="tab" onclick="switchTab(3)">ğŸ¯ Quiz</button>
        </div>

        <div class="content">
            <!-- Tab 1: Vocabulaire -->
            <div class="tab-content active" id="vocab-tab">
                <div id="vocabulary-container"></div>
            </div>

            <!-- Tab 2: Mes Mots PersonnalisÃ©s -->
            <div class="tab-content" id="custom-words-tab">
                <div class="custom-words-container">
                    <div class="info-box">
                        <strong>ğŸ’¡ Astuce :</strong>
                        CrÃ©ez votre propre vocabulaire personnalisÃ© ! Les mots ajoutÃ©s apparaÃ®tront dans les flashcards et les quiz.
                    </div>

                    <!-- Gestionnaire de catÃ©gories -->
                    <div class="category-manager">
                        <h3>ğŸ“ GÃ©rer mes catÃ©gories</h3>
                        <div class="category-input-group">
                            <input type="text" id="new-category-input" placeholder="Nouvelle catÃ©gorie..." maxlength="50">
                            <button class="btn btn-secondary" onclick="addCustomCategory()">+ Ajouter</button>
                        </div>
                        <div class="custom-categories-list" id="custom-categories-list">
                            <!-- Les catÃ©gories personnalisÃ©es apparaÃ®tront ici -->
                        </div>
                    </div>

                    <!-- Formulaire d'ajout -->
                    <div class="add-word-form">
                        <h2>â• Ajouter un mot</h2>
                        <div class="form-group">
                            <label for="word-arabic">Mot en arabe *</label>
                            <input type="text" id="word-arabic" dir="rtl" placeholder="Ø§ÙƒØªØ¨ Ø§Ù„ÙƒÙ„Ù…Ø© Ø¨Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©" required>
                        </div>
                        <div class="form-group">
                            <label for="word-french">Traduction en franÃ§ais *</label>
                            <input type="text" id="word-french" placeholder="Ã‰crivez la traduction" required>
                        </div>
                        <div class="form-group">
                            <label for="word-category">CatÃ©gorie *</label>
                            <select id="word-category" required>
                                <option value="">-- Choisir une catÃ©gorie --</option>
                            </select>
                        </div>
                        <div class="form-actions">
                            <button class="btn btn-primary" onclick="addCustomWord()">âœ“ Ajouter le mot</button>
                            <button class="btn btn-secondary" onclick="clearForm()">âœ• Effacer</button>
                        </div>
                    </div>

                    <!-- Liste des mots personnalisÃ©s -->
                    <div class="custom-words-list">
                        <h3>ğŸ“ Mes mots personnalisÃ©s (<span id="custom-words-count">0</span>)</h3>
                        <div id="custom-words-items">
                            <!-- Les mots apparaÃ®tront ici -->
                        </div>
                    </div>

                    <!-- Export/Import -->
                    <div class="export-import-section">
                        <h3>ğŸ’¾ Sauvegarder / Importer</h3>
                        <div class="export-import-actions">
                            <button class="btn btn-secondary" onclick="exportCustomWords()">â¬‡ï¸ Exporter mes mots</button>
                            <button class="btn btn-secondary" onclick="document.getElementById('import-file').click()">â¬†ï¸ Importer des mots</button>
                            <input type="file" id="import-file" accept=".json" style="display: none;" onchange="importCustomWords(event)">
                            <button class="btn btn-danger" onclick="deleteAllCustomWords()">ğŸ—‘ï¸ Supprimer tout</button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Tab 3: Flashcards -->
            <div class="tab-content" id="flashcards-tab">
                <div class="flashcard-controls" id="flashcard-categories"></div>
                <div style="text-align: center; margin-bottom: 20px;">
                    <div style="margin-bottom: 15px;">
                        <span id="card-count" style="font-size: 1.1em; color: #2c5f2d; font-weight: 600;">0 cartes</span>
                    </div>
                    <button onclick="flipAllCards()" class="flip-control-btn primary">ğŸ”„ Retourner tout</button>
                    <button onclick="resetAllCards()" class="flip-control-btn secondary">â†©ï¸ RÃ©initialiser</button>
                </div>
                <div class="flashcard-container" id="flashcard-container">
                    <!-- Les cartes seront gÃ©nÃ©rÃ©es ici -->
                </div>
            </div>

            <!-- Tab 4: Quiz -->
            <div class="tab-content" id="quiz-tab">
                <div class="quiz-setup" id="quiz-setup">
                    <h2>ğŸ¯ Configurez votre Quiz</h2>
                    <div class="quiz-options">
                        <div class="quiz-option-group">
                            <h3>Choisissez le mode de quiz :</h3>
                            <div class="quiz-buttons" id="quiz-mode-buttons">
                                <button class="category-btn active" onclick="selectQuizMode('qcm')">ğŸ“‹ QCM (Choix multiples)</button>
                                <button class="category-btn" onclick="selectQuizMode('texte')">âœï¸ Texte (Ã‰crire la rÃ©ponse)</button>
                            </div>
                        </div>
                        <div class="quiz-option-group">
                            <h3>Choisissez une catÃ©gorie :</h3>
                            <div class="quiz-buttons" id="quiz-categories"></div>
                        </div>
                    </div>
                    <button class="start-quiz-btn" onclick="startQuiz()">Commencer le Quiz</button>
                    <div style="margin-top: 30px;">
                        <button onclick="resetMemory()" style="padding: 10px 20px; background: #dc3545; color: white; border: none; border-radius: 2px; cursor: pointer; font-size: 0.9em;">
                            ğŸ”„ RÃ©initialiser les statistiques
                        </button>
                    </div>
                </div>

                <div class="quiz-game" id="quiz-game" style="display: none;">
                    <div class="quiz-progress">
                        <div class="progress-bar">
                            <div class="progress-fill" id="progress-fill">0%</div>
                        </div>
                        <div class="quiz-stats">
                            <div class="stat">
                                Question: <span class="stat-value" id="current-question">0</span> / <span id="total-questions">0</span>
                            </div>
                            <div class="stat">
                                Correct: <span class="stat-value" id="correct-answers">0</span>
                            </div>
                            <div class="stat">
                                Incorrect: <span class="stat-value" id="incorrect-answers">0</span>
                            </div>
                        </div>
                    </div>

                    <div class="question-card">
                        <div class="question-text" id="question-text"></div>
                        <div class="question-hint" id="question-hint"></div>
                    </div>

                    <!-- Mode QCM -->
                    <div id="qcm-mode" style="display: none;">
                        <div class="answer-options" id="answer-options"></div>
                    </div>

                    <!-- Mode Texte -->
                    <div id="text-mode" style="display: none;">
                        <div class="text-answer-container">
                            <div class="attempts-display" id="attempts-display">
                                Tentatives restantes : <span class="remaining" id="remaining-attempts">3</span>/3
                            </div>
                            <input type="text" class="text-input" id="text-answer-input" placeholder="Ã‰crivez votre rÃ©ponse ici..." autocomplete="off">
                            <div id="feedback-container"></div>
                            <button class="submit-answer-btn" id="submit-answer-btn" onclick="checkTextAnswer()">
                                Valider
                            </button>
                        </div>
                    </div>

                    <div class="next-btn-container">
                        <button class="next-question-btn" id="next-question-btn" onclick="nextQuestion()" style="display: none;">
                            Question Suivante â†’
                        </button>
                    </div>
                </div>

                <div class="quiz-results" id="quiz-results" style="display: none;">
                    <div class="results-title">ğŸ‰ Quiz TerminÃ© !</div>
                    <div class="results-score" id="final-score"></div>
                    <div class="results-message" id="results-message"></div>
                    <button class="restart-btn" onclick="restartQuiz()">Recommencer</button>
                </div>
            </div>
        </div>
    </div>

    <script>
        // DonnÃ©es du vocabulaire de base
        const baseVocabulary = {
            "Couleurs": [
                { arabic: "Ø£ÙØ­Ù’Ù…ÙØ±", french: "rouge (m.)" },
                { arabic: "Ø­ÙÙ…Ù’Ø±ÙØ§Ø¡", french: "rouge (f.)" },
                { arabic: "Ø£ÙØ®Ù’Ø¶ÙØ±", french: "vert (m.)" },
                { arabic: "Ø®ÙØ¶Ù’Ø±ÙØ§Ø¡", french: "vert (f.)" },
                { arabic: "Ø£ÙØ²Ù’Ø±ÙÙ‚", french: "bleu (m.)" },
                { arabic: "Ø²ÙØ±Ù’Ù‚ÙØ§Ø¡", french: "bleu (f.)" },
                { arabic: "Ø£ÙØµÙ’ÙÙØ±", french: "jaune (m.)" },
                { arabic: "ØµÙÙÙ’Ø±ÙØ§Ø¡", french: "jaune (f.)" },
                { arabic: "Ø£ÙØ³Ù’ÙˆÙØ¯", french: "noir (m.)" },
                { arabic: "Ø³ÙÙˆÙ’Ø¯ÙØ§Ø¡", french: "noir (f.)" },
                { arabic: "Ø£ÙØ¨Ù’ÙŠÙØ¶", french: "blanc (m.)" },
                { arabic: "Ø¨ÙÙŠÙ’Ø¶ÙØ§Ø¡", french: "blanc (f.)" }
            ],
            "Formes": [
                { arabic: "Ù…ÙØ±ÙØ¨ÙÙ‘Ø¹", french: "carrÃ©" },
                { arabic: "Ù…ÙØ³Ù’ØªÙØ·ÙÙŠÙ„", french: "rectangle" },
                { arabic: "Ø®ÙØ·Ù‘ Ù…ÙØ³Ù’ØªÙÙ‚ÙÙŠÙ…", french: "ligne droite" },
                { arabic: "Ù…ÙØ«ÙÙ„ÙÙ‘Ø«", french: "triangle" },
                { arabic: "Ø¯ÙØ§Ø¦ÙØ±ÙØ©", french: "cercle" }
            ],
            "Signes MathÃ©matiques": [
                { arabic: "Ø²ÙØ§Ø¦ÙØ¯", french: "plus (+)" },
                { arabic: "Ù†ÙØ§Ù‚ÙØµ", french: "moins (-)" },
                { arabic: "ÙÙÙŠ", french: "multipliÃ© par (Ã—)" },
                { arabic: "Ø¹ÙÙ„ÙÙ‰", french: "divisÃ© par (Ã·)" },
                { arabic: "ÙŠÙØ³ÙØ§ÙˆÙÙŠ", french: "Ã©gal (=)" },
                { arabic: "Ù„ÙØ§ ÙŠÙØ³ÙØ§ÙˆÙÙŠ", french: "n'est pas Ã©gal (â‰ )" },
                { arabic: "ÙÙÙŠ Ø§Ù„Ù’Ù…ÙØ¦ÙØ©", french: "pour cent (%)" }
            ],
            "Herbivores": [
                { arabic: "Ø£ÙØ³ÙØ¯", french: "lion" },
                { arabic: "Ø¨ÙÙ‚ÙØ±ÙØ©", french: "vache" },
                { arabic: "Ø¨ÙØºÙ’Ù„", french: "mulet" },
                { arabic: "Ø«ÙÙˆÙ’Ø±", french: "taureau" },
                { arabic: "Ø¬ÙØ§Ù…ÙÙˆØ³", french: "buffle" },
                { arabic: "Ø¬ÙÙ…ÙÙ„", french: "chameau" },
                { arabic: "Ø­ÙØµÙØ§Ù†", french: "cheval" },
                { arabic: "Ø­ÙÙ…ÙØ§Ø±", french: "Ã¢ne" },
                { arabic: "Ø­ÙÙ…ÙØ§Ø± ÙˆÙØ­Ù’Ø´ÙÙŠ", french: "zÃ¨bre" },
                { arabic: "Ø®ÙØ±ÙÙˆÙ", french: "mouton" },
                { arabic: "Ø²ÙØ±ÙØ§ÙÙØ©", french: "girafe" },
                { arabic: "Ø³ÙÙ„ÙØ­Ù’ÙÙØ§Ø©", french: "tortue" },
                { arabic: "ØºÙØ²ÙØ§Ù„", french: "gazelle" },
                { arabic: "ÙÙÙŠÙ„", french: "Ã©lÃ©phant" },
                { arabic: "Ù‚ÙØ±Ù’Ø¯", french: "singe" },
                { arabic: "Ù‚ÙÙ†Ù’ÙÙØ°", french: "hÃ©risson" },
                { arabic: "ÙˆÙØ­ÙÙŠØ¯ Ø§Ù„Ù’Ù‚ÙØ±Ù’Ù†", french: "rhinocÃ©ros" }
            ],
            "Carnivores": [
                { arabic: "ØªÙÙ…Ù’Ø³ÙØ§Ø­", french: "crocodile" },
                { arabic: "Ø«ÙØ¹Ù’Ù„ÙØ¨", french: "renard" },
                { arabic: "Ø¯ÙØ¨Ù‘", french: "ours" },
                { arabic: "Ø°ÙØ¦Ù’Ø¨", french: "loup" },
                { arabic: "Ø¶ÙØ¨ÙØ¹", french: "hyÃ¨ne" },
                { arabic: "ÙÙÙ‡Ù’Ø¯", french: "guÃ©pard/lÃ©opard" },
                { arabic: "Ù‚ÙØ·ÙÙ‘Ø©", french: "chatte" },
                { arabic: "ÙƒÙÙ„Ù’Ø¨", french: "chien" },
                { arabic: "Ù„ÙØ¨Ù’ÙˆÙØ©", french: "lionne" },
                { arabic: "Ù†ÙÙ…ÙØ±", french: "tigre" }
            ],
            "Oiseaux": [
                { arabic: "Ø¨ÙØ¨ÙÙ‘ØºÙØ§Ø¡", french: "perroquet" },
                { arabic: "Ø¨ÙØ·ÙÙ‘Ø©", french: "canard/cane" },
                { arabic: "Ø¨ÙØ·Ù’Ø±ÙÙŠÙ‚", french: "pingouin" },
                { arabic: "Ø¨ÙÙˆÙ…ÙØ©", french: "hibou" },
                { arabic: "Ø­ÙÙ…ÙØ§Ù…ÙØ©", french: "colombe/pigeon" },
                { arabic: "Ø®ÙÙÙÙ‘Ø§Ø´", french: "chauve-souris" },
                { arabic: "Ø¯ÙØ¬ÙØ§Ø¬ÙØ©", french: "poule" },
                { arabic: "ØµÙÙ‚Ù’Ø±", french: "faucon" },
                { arabic: "Ø·ÙØ§ÙˆÙÙˆØ³", french: "paon" },
                { arabic: "Ø¹ÙØµÙ’ÙÙÙˆØ±", french: "moineau/oiseau" },
                { arabic: "ØºÙØ±ÙØ§Ø¨", french: "corbeau" },
                { arabic: "Ù†ÙØ³Ù’Ø±", french: "aigle" },
                { arabic: "Ù†ÙØ¹ÙØ§Ù…ÙØ©", french: "autruche" }
            ],
            "Insectes": [
                { arabic: "Ø¨ÙØ¹ÙÙˆØ¶ÙØ©", french: "moustique" },
                { arabic: "Ø¬ÙØ±ÙØ§Ø¯ÙØ©", french: "sauterelle" },
                { arabic: "Ø®ÙÙ†Ù’ÙÙØ³ÙØ§Ø¡", french: "coccinelle" },
                { arabic: "Ø¯ÙÙˆØ¯ÙØ©", french: "ver" },
                { arabic: "Ø°ÙØ¨ÙØ§Ø¨ÙØ©", french: "mouche" },
                { arabic: "ØµÙØ±Ù’ØµÙÙˆØ±", french: "cafard" },
                { arabic: "Ø¹ÙÙ†Ù’ÙƒÙØ¨ÙÙˆØª", french: "araignÃ©e" },
                { arabic: "ÙÙØ±ÙØ§Ø´ÙØ©", french: "papillon" },
                { arabic: "Ù†ÙØ­Ù’Ù„ÙØ©", french: "abeille" },
                { arabic: "Ù†ÙÙ…Ù’Ù„ÙØ©", french: "fourmi" }
            ],
            "Vocabulaire GÃ©nÃ©ral": [
                { arabic: "Ø£ÙØ°ÙÙ†", french: "oreille" },
                { arabic: "Ø¥ÙØ¨Ù’Ø±ÙØ©", french: "aiguille" },
                { arabic: "Ø¥ÙØ¨Ù’Ø±ÙÙŠÙ‚", french: "thÃ©iÃ¨re" },
                { arabic: "Ø¨ÙØ§Ø¨", french: "porte" },
                { arabic: "Ø¨ÙØ­Ù’Ø±", french: "mer" },
                { arabic: "Ø¨ÙØ·ÙÙ‘Ø§Ù†ÙÙŠÙØ©", french: "couverture" },
                { arabic: "Ø¨ÙØ·ÙÙ‘ÙŠØ®", french: "pastÃ¨que" },
                { arabic: "Ø¨ÙØ±Ù’Ø¬", french: "tour" },
                { arabic: "Ø¨ÙÙŠÙ’Øª", french: "maison" },
                { arabic: "ØªÙÙ…Ù’Ø±", french: "dattes" },
                { arabic: "ØªÙÙÙÙ‘Ø§Ø­", french: "pomme" },
                { arabic: "ØªÙÙˆØª", french: "mÃ»res" },
                { arabic: "Ø«ÙÙ„ÙÙ‘Ø§Ø¬ÙØ©", french: "rÃ©frigÃ©rateur" },
                { arabic: "Ø«ÙØ±ÙÙŠÙÙ‘Ø§", french: "lustre" },
                { arabic: "Ø«ÙØ¹Ù’Ø¨ÙØ§Ù†", french: "serpent" },
                { arabic: "Ø«ÙÙˆÙ’Ø¨", french: "vÃªtement/robe" },
                { arabic: "Ø«ÙÙˆÙ…", french: "ail" },
                { arabic: "Ø«ÙÙŠÙØ§Ø¨", french: "vÃªtements" },
                { arabic: "Ø¬ÙØ³Ù’Ø±", french: "pont" },
                { arabic: "Ø¬ÙØ¨Ù’Ù†", french: "fromage" },
                { arabic: "Ø­ÙØ§ÙÙÙ„ÙØ©", french: "bus" },
                { arabic: "Ø­ÙÙ‚ÙÙŠØ¨ÙØ©", french: "valise/sac" },
                { arabic: "Ø­ÙÙˆØª", french: "baleine" },
                { arabic: "Ø®ÙØ¨Ù’Ø²", french: "pain" },
                { arabic: "Ø®ÙÙŠÙØ§Ø±", french: "concombre" },
                { arabic: "Ø¯ÙÙÙ’ØªÙØ±", french: "cahier" },
                { arabic: "Ø¯ÙÙŠÙƒ", french: "coq" },
                { arabic: "Ø°ÙÙ‡ÙØ¨", french: "or" },
                { arabic: "Ø°ÙØ±ÙØ§Ø¹", french: "bras" },
                { arabic: "Ø°ÙØ±ÙØ©", french: "maÃ¯s" },
                { arabic: "Ø°ÙÙŠÙ’Ù„", french: "queue" },
                { arabic: "Ø±ÙÙ†Ù’Ø¬", french: "cuisiniÃ¨re" },
                { arabic: "Ø±ÙÙ…Ù’Ø­", french: "lance" },
                { arabic: "Ø±ÙØ²Ù‘", french: "riz" },
                { arabic: "Ø±ÙÙŠØ´ÙØ©", french: "plume" },
                { arabic: "Ø²ÙÙ‡Ù’Ø±ÙÙŠÙÙ‘Ø©", french: "vase de fleurs" },
                { arabic: "Ø²ÙØ¬ÙØ§Ø¬ÙØ©", french: "bouteille" },
                { arabic: "Ø²ÙÙŠÙ’Øª", french: "huile" },
                { arabic: "Ø²ÙØ±Ù‘", french: "bouton" },
                { arabic: "Ø³ÙØ¨ÙÙ‘ÙˆØ±ÙØ©", french: "tableau (noir)" },
                { arabic: "Ø³ÙØ®ÙÙ‘Ø§Ù†", french: "chauffe-eau" },
                { arabic: "Ø³ÙØ±ÙÙŠØ±", french: "lit" },
                { arabic: "Ø³ÙÙ…ÙÙƒÙØ©", french: "poisson" },
                { arabic: "Ø³ÙÙ…ÙÙ‘Ø§Ø¹ÙØ©", french: "casque audio" },
                { arabic: "Ø³ÙÙŠÙÙ‘Ø§Ø±ÙØ©", french: "voiture" },
                { arabic: "Ø³ÙÙˆÙØ§Ùƒ", french: "siwak (bÃ¢ton Ã  dents)" },
                { arabic: "Ø³ÙÙˆÙ‚", french: "marchÃ©" },
                { arabic: "Ø´ÙØ¬ÙØ±ÙØ©", french: "arbre" },
                { arabic: "Ø´ÙØ¹Ù’Ø±", french: "cheveux" },
                { arabic: "Ø´ÙÙ…Ù’Ø¹ÙØ©", french: "bougie" },
                { arabic: "Ø´ÙØ±ÙØ§Ø¹", french: "voile (bateau)" },
                { arabic: "Ø¶ÙØ¨Ù‘", french: "lÃ©zard" },
                { arabic: "Ø¶ÙØ§Ø¨ÙØ·", french: "officier" },
                { arabic: "Ø¶ÙØ±Ù’Ø³", french: "molaire/dent" },
                { arabic: "Ø¶ÙÙÙ’Ø¯ÙØ¹", french: "grenouille" },
                { arabic: "Ø·ÙØ§Ù„ÙØ¨", french: "Ã©tudiant" },
                { arabic: "Ø·ÙØ¨ÙÙŠØ¨", french: "mÃ©decin" },
                { arabic: "Ø·ÙØ±ÙÙŠÙ‚", french: "route/chemin" },
                { arabic: "Ø·ÙÙˆÙ’Ù‚", french: "collier/anneau" },
                { arabic: "Ø·ÙÙŠÙÙ‘Ø§Ø±", french: "pilote" },
                { arabic: "Ø·ÙÙÙ’Ù„", french: "enfant" },
                { arabic: "Ø·ÙÙˆØ¨ÙØ©", french: "brique" },
                { arabic: "Ø¸ÙØ±Ù’Ù", french: "enveloppe" },
                { arabic: "Ø¸ÙÙ„Ù‘", french: "ombre" },
                { arabic: "Ø¸ÙÙÙ’Ø±", french: "ongle" },
                { arabic: "Ø¹ÙÙŠÙ’Ù†", french: "Å“il" },
                { arabic: "Ø¹ÙÙ†ÙØ¨", french: "raisins" },
                { arabic: "ØºÙÙ…Ù’Ø¯", french: "fourreau/gaine" },
                { arabic: "ØºÙØµÙ’Ù†", french: "branche" },
                { arabic: "ÙÙØ£Ù’Ø±", french: "souris" },
                { arabic: "ÙÙØ¯ÙÙ‘Ø§Ø­ÙØ©", french: "tournevis" },
                { arabic: "ÙÙØ±ÙØ§ÙˆÙ’Ù„ÙØ©", french: "fraise" },
                { arabic: "ÙÙØµÙ’Ù„", french: "classe" },
                { arabic: "ÙÙÙ„Ù’ÙÙÙ„", french: "poivre/poivron" },
                { arabic: "ÙÙÙˆÙ„", french: "fÃ¨ves" },
                { arabic: "Ù‚ÙØ¯ÙÙ…", french: "pied" },
                { arabic: "Ù‚ÙÙÙ’Ù„", french: "cadenas" },
                { arabic: "Ù‚ÙÙ„ÙÙ…", french: "stylo" },
                { arabic: "Ù‚ÙÙ„Ù’Ø¨", french: "cÅ“ur" },
                { arabic: "ÙƒÙØ¹Ù’Ø¨ÙØ©", french: "Kaaba" },
                { arabic: "ÙƒÙØªÙØ§Ø¨", french: "livre" },
                { arabic: "ÙƒÙÙ…ÙÙ‘Ø«Ù’Ø±ÙÙ‰", french: "poire" },
                { arabic: "ÙƒÙÙˆØ¨", french: "verre/tasse" },
                { arabic: "Ù„ÙØ­Ù’Ù…", french: "viande" },
                { arabic: "Ù„ÙÙŠÙ’Ù…ÙÙˆÙ†", french: "citron" },
                { arabic: "Ù„ÙØ³ÙØ§Ù†", french: "langue" },
                { arabic: "Ù„ÙÙˆØ¨ÙÙŠÙØ§", french: "haricots" },
                { arabic: "Ù…ÙØ±ÙÙŠØ¶", french: "malade" },
                { arabic: "Ù…ÙØ³Ù’Ø¬ÙØ¯", french: "mosquÃ©e" },
                { arabic: "Ù…ÙØµÙ’Ø¨ÙØ§Ø­", french: "lampe" },
                { arabic: "Ù…ÙØµÙ’Ø­ÙÙ", french: "Coran" },
                { arabic: "Ù…ÙØ¹ÙÙ„ÙÙ‘Ù…", french: "enseignant" },
                { arabic: "Ù…ÙÙƒÙÙŠÙÙ‘Ù", french: "climatiseur" },
                { arabic: "Ù…ÙÙƒÙ’ØªÙØ¨", french: "bureau" },
                { arabic: "Ù…ÙÙ†Ù’Ø´ÙØ©", french: "scie" },
                { arabic: "Ù…ÙÙ†ÙØ¨ÙÙ‘Ù‡", french: "rÃ©veil" },
                { arabic: "Ù…ÙÙ‡ÙØ±ÙÙ‘Ø¬", french: "clown" },
                { arabic: "Ù…ÙÙÙ’ØªÙØ§Ø­", french: "clÃ©" },
                { arabic: "Ù…ÙØ³Ù’Ù…ÙØ§Ø±", french: "clou/vis" },
                { arabic: "Ù†ÙØ§ÙÙØ°ÙØ©", french: "fenÃªtre" },
                { arabic: "Ù†ÙØ­ÙÙŠÙ", french: "maigre" },
                { arabic: "Ù†ÙØ®Ù’Ù„", french: "palmiers" },
                { arabic: "Ù†ÙÙ‚ÙØ§Ø¨", french: "niqab" },
                { arabic: "Ù†ÙØ¬ÙÙˆÙ…", french: "Ã©toiles" },
                { arabic: "Ù†ÙÙ‚ÙÙˆØ¯", french: "argent/monnaie" },
                { arabic: "Ù‡ÙØ§ØªÙÙ", french: "tÃ©lÃ©phone" },
                { arabic: "Ù‡ÙØ±ÙÙ…", french: "pyramide" },
                { arabic: "Ù‡ÙÙ„ÙØ§Ù„", french: "croissant" },
                { arabic: "Ù‡ÙØ¯Ù’Ù‡ÙØ¯", french: "huppe (oiseau)" },
                { arabic: "ÙˆÙØ±Ù’Ø¯ÙØ©", french: "rose" },
                { arabic: "ÙˆÙØ³ÙØ§Ø¯ÙØ©", french: "oreiller" },
                { arabic: "ÙŠÙØ¯", french: "main" },
                { arabic: "ÙŠÙÙˆØ³ÙÙÙÙŠ", french: "mandarine" }
            ],
            "Verbes": [
                { arabic: "ÙŠÙØ£Ù’ÙƒÙÙ„", french: "il mange" },
                { arabic: "ÙŠÙØªÙØ²ÙÙ„ÙÙ‘Ù‚", french: "il glisse/fait du ski" },
                { arabic: "ÙŠÙØªÙØ³ÙÙ„ÙÙ‘Ù‚", french: "il grimpe/escalade" },
                { arabic: "ÙŠÙØªÙÙ‘ØµÙÙ„", french: "il appelle/contacte" },
                { arabic: "ÙŠÙØªÙÙˆÙØ¶ÙÙ‘Ø£", french: "il fait ses ablutions" },
                { arabic: "ÙŠÙØ¬ÙØ±ÙÙ‘", french: "il tire/traÃ®ne" },
                { arabic: "ÙŠÙØ¬Ù’Ø±ÙÙŠ", french: "il court" },
                { arabic: "ÙŠÙØ¬Ù’Ù„ÙØ³", french: "il s'assoit" },
                { arabic: "ÙŠÙØ­Ù’Ø¬ÙÙ‘", french: "il fait le pÃ¨lerinage" },
                { arabic: "ÙŠÙØ­Ù’ÙÙØ¸", french: "il mÃ©morise/garde" },
                { arabic: "ÙŠÙØ®Ù’Ø±ÙØ¬", french: "il sort" },
                { arabic: "ÙŠÙØ¯Ù’Ø®ÙÙ„", french: "il entre" },
                { arabic: "ÙŠÙØ¯ÙÙ‚ÙÙ‘", french: "il frappe/cogne" },
                { arabic: "ÙŠÙØ°Ù’Ù‡ÙØ¨", french: "il va/part" },
                { arabic: "ÙŠÙØ´ÙÙ…ÙÙ‘", french: "il sent/renifle" },
                { arabic: "ÙŠÙØµÙ’Ø¹ÙØ¯", french: "il monte" },
                { arabic: "ÙŠÙØ¹ÙØ¶ÙÙ‘", french: "il mord" },
                { arabic: "ÙŠÙØºÙÙ„ÙÙ‘Ù‚", french: "il ferme" },
                { arabic: "ÙŠÙÙÙ’ØªÙØ­", french: "il ouvre" },
                { arabic: "ÙŠÙÙ‚Ù’Ø±ÙØ£", french: "il lit" },
                { arabic: "ÙŠÙÙƒÙ’ØªÙØ¨", french: "il Ã©crit" },
                { arabic: "ÙŠÙÙ„Ù’Ø¹ÙØ¨", french: "il joue" },
                { arabic: "ÙŠÙÙ…Ù’Ø´ÙÙŠ", french: "il marche" },
                { arabic: "ÙŠÙÙ†ÙØ§Ù…", french: "il dort" },
                { arabic: "ÙŠÙÙ†Ù’ÙÙØ¶Ù", french: "il secoue/Ã©poussette" },
                { arabic: "ÙŠÙÙ†Ù’Ø²ÙÙ„", french: "il descend" }
            ],
            "Nombres": [
                { arabic: "ØµÙÙÙ’Ø±", french: "zÃ©ro (0)" },
                { arabic: "ÙˆÙØ§Ø­ÙØ¯", french: "un (1)" },
                { arabic: "Ø§Ø«Ù’Ù†ÙØ§Ù†", french: "deux (2)" },
                { arabic: "Ø«ÙÙ„ÙØ§Ø«ÙØ©", french: "trois (3)" },
                { arabic: "Ø£ÙØ±Ù’Ø¨ÙØ¹ÙØ©", french: "quatre (4)" },
                { arabic: "Ø®ÙÙ…Ù’Ø³ÙØ©", french: "cinq (5)" },
                { arabic: "Ø³ÙØªÙÙ‘Ø©", french: "six (6)" },
                { arabic: "Ø³ÙØ¨Ù’Ø¹ÙØ©", french: "sept (7)" },
                { arabic: "Ø«ÙÙ…ÙØ§Ù†ÙÙŠÙØ©", french: "huit (8)" },
                { arabic: "ØªÙØ³Ù’Ø¹ÙØ©", french: "neuf (9)" },
                { arabic: "Ø¹ÙØ´ÙØ±ÙØ©", french: "dix (10)" }
            ],
            "Jours de la Semaine": [
                { arabic: "Ø§Ù„Ø³ÙÙ‘Ø¨Ù’Øª", french: "samedi" },
                { arabic: "Ø§Ù„Ù’Ø£ÙØ­ÙØ¯", french: "dimanche" },
                { arabic: "Ø§Ù„Ù’Ø¥ÙØ«Ù’Ù†ÙÙŠÙ’Ù†", french: "lundi" },
                { arabic: "Ø§Ù„Ø«ÙÙ‘Ù„ÙØ§Ø«ÙØ§Ø¡", french: "mardi" },
                { arabic: "Ø§Ù„Ù’Ø£ÙØ±Ù’Ø¨ÙØ¹ÙØ§Ø¡", french: "mercredi" },
                { arabic: "Ø§Ù„Ù’Ø®ÙÙ…ÙÙŠØ³", french: "jeudi" },
                { arabic: "Ø§Ù„Ù’Ø¬ÙÙ…Ù’Ø¹ÙØ©", french: "vendredi" }
            ]
        };

        // Variables globales
        let currentTab = 0;
        let currentCategory = "Couleurs";
        let currentCardIndex = 0;
        let currentCards = [];
        let isFlipped = false;

        // Variables du quiz
        let quizCategory = "Tout";
        let quizMode = "qcm";
        let quizQuestions = [];
        let currentQuestionIndex = 0;
        let correctCount = 0;
        let incorrectCount = 0;
        let answered = false;
        let remainingAttempts = 3;

        // SystÃ¨me de mÃ©moire et personnalisation
        const STORAGE_KEY = 'arabic_vocab_memory';
        const CUSTOM_WORDS_KEY = 'arabic_custom_words';
        const CUSTOM_CATEGORIES_KEY = 'arabic_custom_categories';
        
        // Fonctions de gestion du vocabulaire personnalisÃ©
        function getCustomWords() {
            const stored = localStorage.getItem(CUSTOM_WORDS_KEY);
            return stored ? JSON.parse(stored) : {};
        }

        function saveCustomWords(words) {
            localStorage.setItem(CUSTOM_WORDS_KEY, JSON.stringify(words));
        }

        function getCustomCategories() {
            const stored = localStorage.getItem(CUSTOM_CATEGORIES_KEY);
            return stored ? JSON.parse(stored) : [];
        }

        function saveCustomCategories(categories) {
            localStorage.setItem(CUSTOM_CATEGORIES_KEY, JSON.stringify(categories));
        }

        function getAllVocabulary() {
            const combined = {...baseVocabulary};
            const customWords = getCustomWords();
            
            // Ajouter les mots personnalisÃ©s
            for (const [category, words] of Object.entries(customWords)) {
                combined[category] = words;
            }
            
            return combined;
        }

        function addCustomCategory() {
            const input = document.getElementById('new-category-input');
            const categoryName = input.value.trim();
            
            if (!categoryName) {
                alert('âš ï¸ Veuillez entrer un nom de catÃ©gorie.');
                return;
            }

            const allCategories = [...Object.keys(baseVocabulary), ...getCustomCategories()];
            if (allCategories.includes(categoryName)) {
                alert('âš ï¸ Cette catÃ©gorie existe dÃ©jÃ .');
                return;
            }

            const categories = getCustomCategories();
            categories.push(categoryName);
            saveCustomCategories(categories);
            
            input.value = '';
            updateCategorySelects();
            displayCustomCategories();
            alert('âœ… CatÃ©gorie ajoutÃ©e avec succÃ¨s !');
        }

        function deleteCustomCategory(categoryName) {
            if (!confirm(`ÃŠtes-vous sÃ»r de vouloir supprimer la catÃ©gorie "${categoryName}" et tous ses mots ?`)) {
                return;
            }

            // Supprimer la catÃ©gorie
            let categories = getCustomCategories();
            categories = categories.filter(c => c !== categoryName);
            saveCustomCategories(categories);

            // Supprimer tous les mots de cette catÃ©gorie
            const customWords = getCustomWords();
            delete customWords[categoryName];
            saveCustomWords(customWords);

            updateCategorySelects();
            displayCustomCategories();
            displayCustomWords();
            displayVocabulary();
            alert('âœ… CatÃ©gorie supprimÃ©e avec succÃ¨s !');
        }

        function displayCustomCategories() {
            const container = document.getElementById('custom-categories-list');
            const categories = getCustomCategories();
            
            if (categories.length === 0) {
                container.innerHTML = '<p style="color: #999; font-size: 0.9em;">Aucune catÃ©gorie personnalisÃ©e pour le moment.</p>';
                return;
            }

            container.innerHTML = categories.map(cat => `
                <div class="category-chip">
                    ${cat}
                    <button onclick="deleteCustomCategory('${cat}')">âœ•</button>
                </div>
            `).join('');
        }

        function updateCategorySelects() {
            const select = document.getElementById('word-category');
            const allCategories = [...Object.keys(baseVocabulary), ...getCustomCategories()].sort();
            
            select.innerHTML = '<option value="">-- Choisir une catÃ©gorie --</option>';
            allCategories.forEach(cat => {
                const option = document.createElement('option');
                option.value = cat;
                option.textContent = cat;
                select.appendChild(option);
            });
        }

        function addCustomWord() {
            const arabic = document.getElementById('word-arabic').value.trim();
            const french = document.getElementById('word-french').value.trim();
            const category = document.getElementById('word-category').value;

            if (!arabic || !french || !category) {
                alert('âš ï¸ Veuillez remplir tous les champs.');
                return;
            }

            const customWords = getCustomWords();
            
            if (!customWords[category]) {
                customWords[category] = [];
            }

            // VÃ©rifier si le mot existe dÃ©jÃ 
            const exists = customWords[category].some(w => w.arabic === arabic);
            if (exists) {
                alert('âš ï¸ Ce mot existe dÃ©jÃ  dans cette catÃ©gorie.');
                return;
            }

            customWords[category].push({ arabic, french });
            saveCustomWords(customWords);

            clearForm();
            displayCustomWords();
            displayVocabulary();
            alert('âœ… Mot ajoutÃ© avec succÃ¨s !');
        }

        function editCustomWord(category, arabic) {
            const customWords = getCustomWords();
            const word = customWords[category].find(w => w.arabic === arabic);
            
            if (!word) return;

            const newFrench = prompt('Nouvelle traduction:', word.french);
            if (newFrench && newFrench.trim()) {
                word.french = newFrench.trim();
                saveCustomWords(customWords);
                displayCustomWords();
                displayVocabulary();
                alert('âœ… Mot modifiÃ© avec succÃ¨s !');
            }
        }

        function deleteCustomWord(category, arabic) {
            if (!confirm('ÃŠtes-vous sÃ»r de vouloir supprimer ce mot ?')) {
                return;
            }

            const customWords = getCustomWords();
            customWords[category] = customWords[category].filter(w => w.arabic !== arabic);
            
            if (customWords[category].length === 0) {
                delete customWords[category];
            }
            
            saveCustomWords(customWords);
            displayCustomWords();
            displayVocabulary();
            alert('âœ… Mot supprimÃ© avec succÃ¨s !');
        }

        function displayCustomWords() {
            const container = document.getElementById('custom-words-items');
            const customWords = getCustomWords();
            const countElement = document.getElementById('custom-words-count');
            
            let totalWords = 0;
            for (const words of Object.values(customWords)) {
                totalWords += words.length;
            }
            
            countElement.textContent = totalWords;

            if (totalWords === 0) {
                container.innerHTML = `
                    <div class="empty-state">
                        <div class="empty-state-icon">ğŸ“</div>
                        <div class="empty-state-text">Aucun mot personnalisÃ© pour le moment.<br>Commencez par en ajouter un ci-dessus !</div>
                    </div>
                `;
                return;
            }

            let html = '';
            for (const [category, words] of Object.entries(customWords)) {
                words.forEach(word => {
                    html += `
                        <div class="custom-word-item">
                            <div class="custom-word-content">
                                <div class="custom-word-arabic">${word.arabic}</div>
                                <div class="custom-word-french">${word.french}</div>
                                <div class="custom-word-category">ğŸ“ ${category}</div>
                            </div>
                            <div class="custom-word-actions">
                                <button class="btn btn-secondary btn-small" onclick="editCustomWord('${category}', '${word.arabic}')">âœï¸ Modifier</button>
                                <button class="btn btn-danger btn-small" onclick="deleteCustomWord('${category}', '${word.arabic}')">ğŸ—‘ï¸</button>
                            </div>
                        </div>
                    `;
                });
            }
            
            container.innerHTML = html;
        }

        function clearForm() {
            document.getElementById('word-arabic').value = '';
            document.getElementById('word-french').value = '';
            document.getElementById('word-category').value = '';
        }

        function exportCustomWords() {
            const customWords = getCustomWords();
            const customCategories = getCustomCategories();
            
            const data = {
                words: customWords,
                categories: customCategories,
                exportDate: new Date().toISOString()
            };

            const blob = new Blob([JSON.stringify(data, null, 2)], { type: 'application/json' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `vocabulaire_arabe_${new Date().toISOString().split('T')[0]}.json`;
            a.click();
            URL.revokeObjectURL(url);
        }

        function importCustomWords(event) {
            const file = event.target.files[0];
            if (!file) return;

            const reader = new FileReader();
            reader.onload = function(e) {
                try {
                    const data = JSON.parse(e.target.result);
                    
                    if (!data.words || !data.categories) {
                        throw new Error('Format de fichier invalide');
                    }

                    // Fusionner avec les donnÃ©es existantes
                    const existingWords = getCustomWords();
                    const existingCategories = getCustomCategories();

                    // Fusionner les catÃ©gories
                    const allCategories = [...new Set([...existingCategories, ...data.categories])];
                    saveCustomCategories(allCategories);

                    // Fusionner les mots
                    for (const [category, words] of Object.entries(data.words)) {
                        if (!existingWords[category]) {
                            existingWords[category] = [];
                        }
                        
                        words.forEach(newWord => {
                            const exists = existingWords[category].some(w => w.arabic === newWord.arabic);
                            if (!exists) {
                                existingWords[category].push(newWord);
                            }
                        });
                    }
                    
                    saveCustomWords(existingWords);

                    updateCategorySelects();
                    displayCustomCategories();
                    displayCustomWords();
                    displayVocabulary();
                    
                    alert('âœ… DonnÃ©es importÃ©es avec succÃ¨s !');
                } catch (error) {
                    alert('âŒ Erreur lors de l\'importation : ' + error.message);
                }
            };
            reader.readAsText(file);
            event.target.value = '';
        }

        function deleteAllCustomWords() {
            if (!confirm('âš ï¸ ATTENTION : ÃŠtes-vous sÃ»r de vouloir supprimer TOUS vos mots et catÃ©gories personnalisÃ©s ? Cette action est irrÃ©versible !')) {
                return;
            }

            if (!confirm('DerniÃ¨re confirmation : Tous vos mots personnalisÃ©s seront dÃ©finitivement supprimÃ©s.')) {
                return;
            }

            localStorage.removeItem(CUSTOM_WORDS_KEY);
            localStorage.removeItem(CUSTOM_CATEGORIES_KEY);
            
            updateCategorySelects();
            displayCustomCategories();
            displayCustomWords();
            displayVocabulary();
            
            alert('âœ… Tous les mots personnalisÃ©s ont Ã©tÃ© supprimÃ©s.');
        }

        function getVocabMemory() {
            const stored = localStorage.getItem(STORAGE_KEY);
            return stored ? JSON.parse(stored) : {};
        }

        function saveVocabMemory(memory) {
            localStorage.setItem(STORAGE_KEY, JSON.stringify(memory));
        }

        function updateWordStats(arabicWord, isCorrect) {
            const memory = getVocabMemory();
            
            if (!memory[arabicWord]) {
                memory[arabicWord] = {
                    correct: 0,
                    incorrect: 0,
                    consecutiveErrors: 0,
                    lastAttempt: Date.now()
                };
            }

            if (isCorrect) {
                memory[arabicWord].correct++;
                memory[arabicWord].consecutiveErrors = 0;
            } else {
                memory[arabicWord].incorrect++;
                memory[arabicWord].consecutiveErrors++;
            }
            
            memory[arabicWord].lastAttempt = Date.now();
            saveVocabMemory(memory);
        }

        function getWordDifficulty(arabicWord) {
            const memory = getVocabMemory();
            const stats = memory[arabicWord];
            
            if (!stats) return 'default';
            
            if (stats.consecutiveErrors >= 4) return 'very-hard';
            if (stats.consecutiveErrors >= 2) return 'hard';
            
            const total = stats.correct + stats.incorrect;
            if (total === 0) return 'default';
            
            const successRate = stats.correct / total;
            
            if (successRate >= 0.7 && total >= 3) return 'mastered';
            if (stats.incorrect > 0 && successRate < 0.7) return 'learning';
            
            return 'default';
        }

        function getDifficultyColor(difficulty) {
            const colors = {
                'very-hard': '#dc3545',
                'hard': '#fd7e14',
                'learning': '#ffc107',
                'mastered': '#28a745',
                'default': '#97bc62'
            };
            return colors[difficulty] || colors.default;
        }

        // Initialisation
        window.onload = function() {
            updateCategorySelects();
            displayCustomCategories();
            displayCustomWords();
            displayVocabulary();
            setupFlashcards();
            setupQuiz();
            displayMemoryStats();
        };

        // Gestion des onglets
        function switchTab(tabIndex) {
            const tabs = document.querySelectorAll('.tab');
            const contents = document.querySelectorAll('.tab-content');
            
            tabs.forEach((tab, index) => {
                if (index === tabIndex) {
                    tab.classList.add('active');
                } else {
                    tab.classList.remove('active');
                }
            });

            contents.forEach((content, index) => {
                if (index === tabIndex) {
                    content.classList.add('active');
                } else {
                    content.classList.remove('active');
                }
            });

            currentTab = tabIndex;

            if (tabIndex === 2) { // Flashcards tab
                loadCards(currentCategory);
            }
        }

        // Affichage du vocabulaire
        function displayVocabulary() {
            const container = document.getElementById('vocabulary-container');
            container.innerHTML = '';
            
            addColorLegend();

            const vocabulary = getAllVocabulary();
            const customWords = getCustomWords();

            for (const [category, words] of Object.entries(vocabulary)) {
                const isCustom = customWords.hasOwnProperty(category);
                
                const categoryDiv = document.createElement('div');
                categoryDiv.className = 'category' + (isCustom ? ' custom-category' : '');

                const titleDiv = document.createElement('div');
                titleDiv.className = 'category-title';
                titleDiv.innerHTML = category + (isCustom ? ' <span class="category-badge">Mes mots</span>' : '');
                categoryDiv.appendChild(titleDiv);

                const gridDiv = document.createElement('div');
                gridDiv.className = 'vocab-grid';

                words.forEach(word => {
                    const itemDiv = document.createElement('div');
                    itemDiv.className = 'vocab-item';
                    
                    const difficulty = getWordDifficulty(word.arabic);
                    const color = getDifficultyColor(difficulty);
                    itemDiv.style.borderLeftColor = color;
                    itemDiv.style.borderLeftWidth = '4px';

                    const arabicDiv = document.createElement('div');
                    arabicDiv.className = 'arabic-text';
                    arabicDiv.textContent = word.arabic;

                    const frenchDiv = document.createElement('div');
                    frenchDiv.className = 'french-text';
                    frenchDiv.textContent = word.french;

                    itemDiv.appendChild(arabicDiv);
                    itemDiv.appendChild(frenchDiv);
                    gridDiv.appendChild(itemDiv);
                });

                categoryDiv.appendChild(gridDiv);
                container.appendChild(categoryDiv);
            }
            
            displayMemoryStats();
        }

        // Configuration des flashcards
        function setupFlashcards() {
            const container = document.getElementById('flashcard-categories');
            container.innerHTML = '';

            const allBtn = document.createElement('button');
            allBtn.className = 'category-btn';
            allBtn.textContent = 'ğŸ“š Tout';
            allBtn.onclick = () => selectCategory('Tout');
            container.appendChild(allBtn);

            const vocabulary = getAllVocabulary();
            const customWords = getCustomWords();
            
            for (const category of Object.keys(vocabulary)) {
                const btn = document.createElement('button');
                btn.className = 'category-btn' + (customWords.hasOwnProperty(category) ? ' custom' : '');
                btn.textContent = category;
                btn.onclick = () => selectCategory(category);
                container.appendChild(btn);
            }
        }

        function selectCategory(category) {
            currentCategory = category;
            const buttons = document.querySelectorAll('#flashcard-categories .category-btn');
            buttons.forEach(btn => {
                if (btn.textContent === category || (category === 'Tout' && btn.textContent === 'ğŸ“š Tout')) {
                    btn.classList.add('active');
                } else {
                    btn.classList.remove('active');
                }
            });
            loadCards(category);
        }

        function loadCards(category) {
            currentCards = [];
            const vocabulary = getAllVocabulary();
            
            if (category === 'Tout') {
                for (const words of Object.values(vocabulary)) {
                    currentCards = currentCards.concat(words);
                }
            } else {
                currentCards = vocabulary[category] || [];
            }

            displayAllCards();
        }

        function displayAllCards() {
            const container = document.getElementById('flashcard-container');
            container.innerHTML = '';

            const countElement = document.getElementById('card-count');
            if (countElement) {
                countElement.textContent = `${currentCards.length} carte${currentCards.length > 1 ? 's' : ''}`;
            }

            if (currentCards.length === 0) {
                container.innerHTML = '<p style="text-align: center; color: #666; padding: 40px;">Aucune carte disponible</p>';
                return;
            }

            currentCards.forEach((card, index) => {
                const flashcardDiv = document.createElement('div');
                flashcardDiv.className = 'flashcard';
                flashcardDiv.id = `flashcard-${index}`;
                
                flashcardDiv.innerHTML = `
                    <div class="flashcard-inner">
                        <div class="flashcard-front">${card.french}</div>
                        <div class="flashcard-back">${card.arabic}</div>
                    </div>
                `;
                
                flashcardDiv.addEventListener('click', function() {
                    this.classList.toggle('flipped');
                });
                
                container.appendChild(flashcardDiv);
            });
        }

        function flipAllCards() {
            const allCards = document.querySelectorAll('.flashcard');
            allCards.forEach(card => {
                card.classList.add('flipped');
            });
        }

        function resetAllCards() {
            const allCards = document.querySelectorAll('.flashcard');
            allCards.forEach(card => {
                card.classList.remove('flipped');
            });
        }

        // Configuration du quiz
        function setupQuiz() {
            const container = document.getElementById('quiz-categories');
            container.innerHTML = '';

            const allBtn = document.createElement('button');
            allBtn.className = 'category-btn active';
            allBtn.textContent = 'ğŸ“š Tout le vocabulaire';
            allBtn.onclick = () => selectQuizCategory('Tout');
            container.appendChild(allBtn);

            const vocabulary = getAllVocabulary();
            const customWords = getCustomWords();
            
            for (const category of Object.keys(vocabulary)) {
                const btn = document.createElement('button');
                btn.className = 'category-btn' + (customWords.hasOwnProperty(category) ? ' custom' : '');
                btn.textContent = category;
                btn.onclick = () => selectQuizCategory(category);
                container.appendChild(btn);
            }
        }

        function selectQuizCategory(category) {
            quizCategory = category;
            const buttons = document.querySelectorAll('#quiz-categories .category-btn');
            buttons.forEach(btn => {
                if (btn.textContent === category || (category === 'Tout' && btn.textContent === 'ğŸ“š Tout le vocabulaire')) {
                    btn.classList.add('active');
                } else {
                    btn.classList.remove('active');
                }
            });
        }

        function selectQuizMode(mode) {
            quizMode = mode;
            const buttons = document.querySelectorAll('#quiz-mode-buttons .category-btn');
            buttons.forEach(btn => {
                btn.classList.remove('active');
            });
            event.target.classList.add('active');
        }

        function startQuiz() {
            quizQuestions = [];
            const vocabulary = getAllVocabulary();
            
            if (quizCategory === 'Tout') {
                for (const words of Object.values(vocabulary)) {
                    quizQuestions = quizQuestions.concat(words);
                }
            } else {
                quizQuestions = vocabulary[quizCategory] || [];
            }

            if (quizQuestions.length === 0) {
                alert('Aucun mot disponible pour cette catÃ©gorie !');
                return;
            }

            quizQuestions = shuffleArray([...quizQuestions]);

            currentQuestionIndex = 0;
            correctCount = 0;
            incorrectCount = 0;

            document.getElementById('quiz-setup').style.display = 'none';
            document.getElementById('quiz-game').style.display = 'block';
            document.getElementById('quiz-results').style.display = 'none';

            showQuestion();
        }

        function showQuestion() {
            if (currentQuestionIndex >= quizQuestions.length) {
                showResults();
                return;
            }

            answered = false;
            remainingAttempts = 3;
            const question = quizQuestions[currentQuestionIndex];

            const progress = ((currentQuestionIndex) / quizQuestions.length) * 100;
            document.getElementById('progress-fill').style.width = progress + '%';
            document.getElementById('progress-fill').textContent = Math.round(progress) + '%';

            document.getElementById('current-question').textContent = currentQuestionIndex + 1;
            document.getElementById('total-questions').textContent = quizQuestions.length;
            document.getElementById('correct-answers').textContent = correctCount;
            document.getElementById('incorrect-answers').textContent = incorrectCount;

            if (quizMode === 'qcm') {
                document.getElementById('qcm-mode').style.display = 'block';
                document.getElementById('text-mode').style.display = 'none';
                
                document.getElementById('question-text').textContent = question.french;
                document.getElementById('question-hint').textContent = 'Quelle est la traduction en arabe ?';

                const options = generateOptions(question);
                const optionsContainer = document.getElementById('answer-options');
                optionsContainer.innerHTML = '';

                options.forEach((option, index) => {
                    const btn = document.createElement('button');
                    btn.className = 'answer-btn';
                    btn.textContent = option.arabic;
                    btn.onclick = () => checkAnswer(option, question, btn);
                    optionsContainer.appendChild(btn);
                });
            } else {
                document.getElementById('qcm-mode').style.display = 'none';
                document.getElementById('text-mode').style.display = 'block';
                
                document.getElementById('question-text').textContent = question.arabic;
                document.getElementById('question-hint').textContent = 'Ã‰crivez la traduction en franÃ§ais';

                const input = document.getElementById('text-answer-input');
                input.value = '';
                input.className = 'text-input';
                input.disabled = false;
                input.focus();
                
                document.getElementById('feedback-container').innerHTML = '';
                document.getElementById('remaining-attempts').textContent = '3';
                document.getElementById('submit-answer-btn').disabled = false;
                
                input.onkeypress = function(e) {
                    if (e.key === 'Enter' && !answered) {
                        checkTextAnswer();
                    }
                };
            }

            document.getElementById('next-question-btn').style.display = 'none';
        }

        function checkTextAnswer() {
            if (answered) return;

            const input = document.getElementById('text-answer-input');
            const userAnswer = input.value.trim();
            const question = quizQuestions[currentQuestionIndex];
            const correctAnswer = question.french;

            const normalizedUser = normalizeText(userAnswer);
            const normalizedCorrect = normalizeText(correctAnswer);

            const feedbackContainer = document.getElementById('feedback-container');
            
            if (normalizedUser === normalizedCorrect) {
                answered = true;
                correctCount++;
                
                input.className = 'text-input correct';
                input.disabled = true;
                
                feedbackContainer.innerHTML = `
                    <div class="feedback-message success">
                        âœ“ Correct ! La rÃ©ponse Ã©tait bien : <strong>${correctAnswer}</strong>
                    </div>
                `;
                
                document.getElementById('submit-answer-btn').disabled = true;
                document.getElementById('next-question-btn').style.display = 'inline-block';
                
                updateWordStats(question.arabic, true);
                displayVocabulary();
                
                document.getElementById('correct-answers').textContent = correctCount;
            } else {
                remainingAttempts--;
                document.getElementById('remaining-attempts').textContent = remainingAttempts;
                
                if (remainingAttempts > 0) {
                    input.className = 'text-input incorrect';
                    
                    feedbackContainer.innerHTML = `
                        <div class="feedback-message error">
                            âœ— Incorrect. Il vous reste ${remainingAttempts} tentative${remainingAttempts > 1 ? 's' : ''}. RÃ©essayez !
                        </div>
                    `;
                    
                    input.select();
                } else {
                    answered = true;
                    incorrectCount++;
                    
                    input.className = 'text-input incorrect';
                    input.disabled = true;
                    
                    feedbackContainer.innerHTML = `
                        <div class="feedback-message error">
                            âœ— Aucune tentative restante. La bonne rÃ©ponse Ã©tait : <strong>${correctAnswer}</strong>
                        </div>
                    `;
                    
                    document.getElementById('submit-answer-btn').disabled = true;
                    document.getElementById('next-question-btn').style.display = 'inline-block';
                    
                    updateWordStats(question.arabic, false);
                    displayVocabulary();
                    
                    document.getElementById('incorrect-answers').textContent = incorrectCount;
                }
            }
        }

        function normalizeText(text) {
            return text
                .toLowerCase()
                .normalize("NFD").replace(/[\u0300-\u036f]/g, "")
                .replace(/[^\w\s]/g, '')
                .replace(/\s+/g, ' ')
                .trim();
        }

        function generateOptions(correctAnswer) {
            const vocabulary = getAllVocabulary();
            const allWords = [];
            for (const words of Object.values(vocabulary)) {
                allWords.push(...words);
            }

            const options = [correctAnswer];
            const usedArabic = new Set([correctAnswer.arabic]);

            while (options.length < 4 && allWords.length >= 4) {
                const randomWord = allWords[Math.floor(Math.random() * allWords.length)];
                if (!usedArabic.has(randomWord.arabic)) {
                    options.push(randomWord);
                    usedArabic.add(randomWord.arabic);
                }
            }

            return shuffleArray(options);
        }

        function checkAnswer(selected, correct, btn) {
            if (answered) return;
            answered = true;

            const buttons = document.querySelectorAll('.answer-btn');
            buttons.forEach(b => b.style.pointerEvents = 'none');

            const isCorrect = selected.arabic === correct.arabic;

            if (isCorrect) {
                btn.classList.add('correct');
                correctCount++;
            } else {
                btn.classList.add('incorrect');
                buttons.forEach(b => {
                    if (b.textContent === correct.arabic) {
                        b.classList.add('correct');
                    }
                });
                incorrectCount++;
            }

            updateWordStats(correct.arabic, isCorrect);
            displayVocabulary();

            document.getElementById('correct-answers').textContent = correctCount;
            document.getElementById('incorrect-answers').textContent = incorrectCount;
            document.getElementById('next-question-btn').style.display = 'inline-block';
        }

        function nextQuestion() {
            currentQuestionIndex++;
            showQuestion();
        }

        function showResults() {
            document.getElementById('quiz-game').style.display = 'none';
            document.getElementById('quiz-results').style.display = 'block';

            const percentage = Math.round((correctCount / quizQuestions.length) * 100);
            document.getElementById('final-score').textContent = `${correctCount} / ${quizQuestions.length} (${percentage}%)`;

            let message = '';
            if (percentage === 100) {
                message = 'ğŸ‰ Parfait ! Vous maÃ®trisez ce vocabulaire !';
            } else if (percentage >= 80) {
                message = 'ğŸ‘ Excellent travail ! Continuez comme Ã§a !';
            } else if (percentage >= 60) {
                message = 'ğŸ‘ Bon travail ! Encore un peu de pratique et ce sera parfait !';
            } else {
                message = 'ğŸ’ª Continuez Ã  pratiquer ! Vous progresserez rapidement !';
            }

            document.getElementById('results-message').textContent = message;
        }

        function restartQuiz() {
            document.getElementById('quiz-setup').style.display = 'block';
            document.getElementById('quiz-game').style.display = 'none';
            document.getElementById('quiz-results').style.display = 'none';
        }

        function shuffleArray(array) {
            const newArray = [...array];
            for (let i = newArray.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [newArray[i], newArray[j]] = [newArray[j], newArray[i]];
            }
            return newArray;
        }

        function displayMemoryStats() {
            const memory = getVocabMemory();
            const totalWords = Object.keys(memory).length;
            
            let veryHard = 0, hard = 0, learning = 0, mastered = 0;
            
            for (const word in memory) {
                const diff = getWordDifficulty(word);
                if (diff === 'very-hard') veryHard++;
                else if (diff === 'hard') hard++;
                else if (diff === 'learning') learning++;
                else if (diff === 'mastered') mastered++;
            }

            const statsDiv = document.getElementById('memory-stats');
            if (totalWords > 0) {
                statsDiv.innerHTML = `
                    <strong>Progression :</strong> 
                    <span style="color: #28a745;">âœ“ ${mastered} maÃ®trisÃ©s</span> | 
                    <span style="color: #ffc107;">âš¡ ${learning} en cours</span> | 
                    <span style="color: #fd7e14;">âš  ${hard} difficiles</span> | 
                    <span style="color: #dc3545;">âœ— ${veryHard} Ã  revoir</span>
                `;
            }
        }

        function addColorLegend() {
            const container = document.getElementById('vocabulary-container');
            
            const legendDiv = document.createElement('div');
            legendDiv.style.cssText = `
                background: #fafaf8;
                padding: 20px;
                border-radius: 2px;
                margin-bottom: 30px;
                border: 1px solid #e0e0dc;
                text-align: center;
            `;
            
            legendDiv.innerHTML = `
                <h3 style="color: #2c5f2d; margin-bottom: 15px; font-size: 1.2em;">ğŸ“Š LÃ©gende des couleurs</h3>
                <div style="display: flex; justify-content: center; gap: 20px; flex-wrap: wrap; font-size: 0.95em;">
                    <div><span style="display: inline-block; width: 20px; height: 20px; background: #dc3545; vertical-align: middle; margin-right: 5px;"></span> Ã€ revoir (4+ erreurs)</div>
                    <div><span style="display: inline-block; width: 20px; height: 20px; background: #fd7e14; vertical-align: middle; margin-right: 5px;"></span> Difficile (2-3 erreurs)</div>
                    <div><span style="display: inline-block; width: 20px; height: 20px; background: #ffc107; vertical-align: middle; margin-right: 5px;"></span> En apprentissage</div>
                    <div><span style="display: inline-block; width: 20px; height: 20px; background: #28a745; vertical-align: middle; margin-right: 5px;"></span> MaÃ®trisÃ© (70%+ rÃ©ussite)</div>
                    <div><span style="display: inline-block; width: 20px; height: 20px; background: #97bc62; vertical-align: middle; margin-right: 5px;"></span> Non testÃ©</div>
                </div>
            `;
            
            container.insertBefore(legendDiv, container.firstChild);
        }

        function resetMemory() {
            if (confirm('âš ï¸ ÃŠtes-vous sÃ»r de vouloir rÃ©initialiser toutes vos statistiques d\'apprentissage ?')) {
                localStorage.removeItem(STORAGE_KEY);
                displayVocabulary();
                displayMemoryStats();
                alert('âœ… Statistiques rÃ©initialisÃ©es avec succÃ¨s !');
            }
        }
    </script>
</body>
</html>
